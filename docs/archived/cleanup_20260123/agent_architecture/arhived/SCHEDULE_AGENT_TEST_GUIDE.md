# Schedule Agent 测试指南

## 快速启动

```bash
# 1. 启动数据库 (如未运行)
make docker-up

# 2. 启动后端 (在项目根目录)
make dev

# 3. 启动前端 (在另一个终端)
cd web && npm run dev
```

访问: `http://localhost:25173`

---

## 测试场景

### 场景 1: 创建日程 (Agent 模式)

1. 打开 AI Chat 页面
2. 点击 "+" 按钮或日程图标
3. 确认 "使用智能 Agent 解析" 开关是**开启**状态
4. 输入: `明天下午3点和产品团队开会`
5. 点击 "智能解析" 按钮
6. 等待处理，查看 Agent 响应
7. 点击 "刷新日程" 按钮
8. 验证: 新日程出现在日程列表中

**预期结果**:
- ✅ Agent 显示 "已成功创建日程"
- ✅ 日程列表包含新创建的日程
- ✅ 时间、标题正确

---

### 场景 2: 查询日程 (Agent 模式)

1. 打开日程创建对话框
2. 确保 Agent 模式开启
3. 输入: `查看本周有哪些日程`
4. 点击 "智能解析"

**预期结果**:
- ✅ Agent 返回本周的日程列表
- ✅ 显示每个日程的标题、时间、地点

---

### 场景 3: 复杂自然语言创建

1. 打开日程创建对话框
2. Agent 模式开启
3. 尝试以下输入:
   - `下周三上午10点到11点进行代码审查`
   - `后天下午2点和市场部开会讨论Q1计划`
   - `下周一早上9点开全员大会`

**预期结果**:
- ✅ 所有输入都能正确解析
- ✅ 时间、时长、标题正确

---

### 场景 4: 切换到传统模式

1. 打开日程创建对话框
2. 关闭 "使用智能 Agent 解析" 开关
3. 输入: `后天下午2点开会`
4. 点击 "创建日程" (不是 "智能解析")

**预期结果**:
- ✅ 显示表单编辑界面
- ✅ 可以手动调整时间、标题等字段
- ✅ 可以保存创建

---

### 场景 5: 错误处理

1. Agent 模式下输入无效内容: `xxxxx`
2. 点击 "智能解析"

**预期结果**:
- ✅ 显示错误提示
- ✅ 提示信息友好
- ✅ 可以切换到传统模式重试

---

## 验证检查点

### 功能检查

- [ ] Agent 模式开关可以切换
- [ ] 智能解析按钮显示正确图标和文字
- [ ] Agent 响应区域显示正常
- [ ] "清除" 按钮可以清空输入和响应
- [ ] "刷新日程" 按钮可以刷新列表
- [ ] 传统模式仍然正常工作

### 性能检查

- [ ] Agent 响应时间 < 10 秒 (简单查询)
- [ ] Agent 响应时间 < 15 秒 (创建日程)
- [ ] 无内存泄漏
- [ ] 无重复 API 调用

### UI/UX 检查

- [ ] 加载状态显示 Loader 图标
- [ ] 错误提示使用 toast 显示
- [ ] 成功提示使用 toast 显示
- [ ] 响应区域格式化良好
- [ ] 移动端适配正常

---

## 已知限制

1. **刷新方式**: 当前使用 `window.location.reload()` 刷新，会重新加载整个页面
2. **流式响应**: 暂未实现实时显示 Agent 思考过程
3. **多轮对话**: 暂不支持连续优化创建

---

## 问题排查

### Agent 无响应

1. 检查浏览器控制台是否有错误
2. 检查后端日志: `make logs backend`
3. 验证 AI 功能已启用: `cat .env | grep AI`
4. 确认 API Key 有效

### 创建失败

1. 检查网络连接
2. 尝试切换到传统模式
3. 简化输入表达
4. 查看后端日志错误信息

### 日程未显示

1. 点击 "刷新日程" 按钮
2. 或关闭对话框重新打开
3. 检查日期范围是否正确

---

## 测试日志模板

```
测试日期: __________
测试人: __________
浏览器: __________

场景 1: [ ] 通过 / [ ] 失败
备注: __________

场景 2: [ ] 通过 / [ ] 失败
备注: __________

场景 3: [ ] 通过 / [ ] 失败
备注: __________

场景 4: [ ] 通过 / [ ] 失败
备注: __________

场景 5: [ ] 通过 / [ ] 失败
备注: __________

总体评价: __________
```
