# æ—¥ç¨‹æ™ºèƒ½ä½“é›†æˆè¯´æ˜

## âœ… å·²å®Œæˆçš„é›†æˆ

æˆ‘ä»¬å·²ç»æˆåŠŸå°†æ–°ç‰ˆ Schedule Agent é›†æˆåˆ°å‰ç«¯æ—¥ç¨‹åˆ›å»ºåŠŸèƒ½ä¸­ï¼

### æ–°å¢åŠŸèƒ½

#### 1. **æ™ºèƒ½ Agent æ¨¡å¼** âœ¨

åœ¨åˆ›å»ºæ—¥ç¨‹å¯¹è¯æ¡†ä¸­ï¼Œç°åœ¨æœ‰ä¸€ä¸ª**æ™ºèƒ½ Agent è§£æ**å¼€å…³ï¼š

- **å¼€å¯æ—¶**ï¼šä½¿ç”¨åŸºäº ReAct çš„æ™ºèƒ½ Agent
  - æ”¯æŒè‡ªç„¶è¯­è¨€æŸ¥è¯¢ï¼ˆ"æŸ¥çœ‹æ˜å¤©çš„æ—¥ç¨‹"ï¼‰
  - æ”¯æŒè‡ªç„¶è¯­è¨€åˆ›å»ºï¼ˆ"åå¤©ä¸‹åˆ2ç‚¹å¼€ä¼š"ï¼‰
  - è‡ªåŠ¨å†²çªæ£€æµ‹
  - æ›´æ™ºèƒ½çš„æ—¶é—´ç†è§£

- **å…³é—­æ—¶**ï¼šä½¿ç”¨åŸæœ‰çš„è§£æå™¨
  - åŸºäºè§„åˆ™çš„ç®€å•è§£æ
  - ä»…æ”¯æŒåˆ›å»ºæ—¥ç¨‹

#### 2. **æ–°å¢çš„ UI å…ƒç´ **

- **å¼€å…³ç»„ä»¶**ï¼šåˆ‡æ¢æ™ºèƒ½ Agent æ¨¡å¼
- **æ™ºèƒ½è§£ææŒ‰é’®**ï¼šå¸¦æœºå™¨äººå›¾æ ‡çš„è§£ææŒ‰é’®
- **Agent å“åº”æ˜¾ç¤º**ï¼šæ˜¾ç¤ºæ™ºèƒ½åŠ©æ‰‹çš„å›å¤
- **å¿«æ·æ“ä½œ**ï¼šæ¸…é™¤ã€åˆ·æ–°æ—¥ç¨‹æŒ‰é’®

---

## ğŸ¯ ä½¿ç”¨æ–¹æ³•

### æ–¹å¼ 1ï¼šåœ¨ AI Chat ä¸­åˆ›å»ºæ—¥ç¨‹

1. ç‚¹å‡» AI Chat ä¸­çš„ "+" æŒ‰é’®æˆ–æ—¥ç¨‹å›¾æ ‡
2. åœ¨å¼¹å‡ºçš„å¯¹è¯æ¡†ä¸­ï¼Œç¡®ä¿**"ä½¿ç”¨æ™ºèƒ½ Agent è§£æ"**å¼€å…³æ˜¯**å¼€å¯**çŠ¶æ€
3. åœ¨æ–‡æœ¬æ¡†ä¸­è¾“å…¥è‡ªç„¶è¯­è¨€ï¼š
   - åˆ›å»ºï¼š`æ˜å¤©ä¸‹åˆ3ç‚¹å’Œäº§å“å›¢é˜Ÿå¼€ä¼š`
   - æŸ¥è¯¢ï¼š`æŸ¥çœ‹æœ¬å‘¨æœ‰å“ªäº›æ—¥ç¨‹`
4. ç‚¹å‡»**"æ™ºèƒ½è§£æ"**æŒ‰é’®
5. ç­‰å¾… Agent å¤„ç†ï¼ŒæŸ¥çœ‹å“åº”
6. ç‚¹å‡»**"åˆ·æ–°æ—¥ç¨‹"**æŸ¥çœ‹æ–°åˆ›å»ºçš„æ—¥ç¨‹

### æ–¹å¼ 2ï¼šç›´æ¥ä½¿ç”¨ Schedule Agent API

```typescript
import { useScheduleAgentChat } from "@/hooks/useScheduleQueries";

function MyComponent() {
  const agentChat = useScheduleAgentChat();

  const handleAgentCreate = async () => {
    try {
      const result = await agentChat.mutateAsync({
        message: "åå¤©ä¸‹åˆ2ç‚¹å¼€ä¸ªäº§å“è®¨è®ºä¼š",
        userTimezone: "Asia/Shanghai",
      });

      console.log("Agent response:", result.response);
    } catch (error) {
      console.error("Agent error:", error);
    }
  };
}
```

---

## ğŸ”„ ä¸æ—§åŠŸèƒ½çš„å¯¹æ¯”

| ç‰¹æ€§ | æ—§è§£æå™¨ | æ–° Agent |
|------|----------|----------|
| æŸ¥è¯¢æ—¥ç¨‹ | âŒ ä¸æ”¯æŒ | âœ… æ”¯æŒ |
| è‡ªç„¶è¯­è¨€ç†è§£ | âš ï¸ è§„åˆ™åŒ¹é… | âœ… LLM ç†è§£ |
| å†²çªæ£€æµ‹ | âœ… æ”¯æŒ | âœ… æ”¯æŒ |
| æ—¶é—´è¡¨è¾¾ | âš ï¸ ç®€å•æ ¼å¼ | âœ… çµæ´»æ ¼å¼ |
| å¯æ‰©å±•æ€§ | âŒ ä½ | âœ… é«˜ |
| é”™è¯¯å¤„ç† | âš ï¸ åŸºç¡€ | âœ… è¯¦ç»†åé¦ˆ |

---

## ğŸ“ ä¿®æ”¹çš„æ–‡ä»¶

| æ–‡ä»¶ | ä¿®æ”¹ç±»å‹ | è¯´æ˜ |
|------|----------|------|
| `web/src/connect.ts` | æ–°å¢ | æ·»åŠ  `scheduleAgentServiceClient` |
| `web/src/hooks/useScheduleAgent.ts` | æ–°å¢ | Agent API hooks |
| `web/src/hooks/useScheduleQueries.ts` | ä¿®æ”¹ | å¯¼å‡ºæ–° hooks |
| `web/src/components/AIChat/ScheduleInput.tsx` | ä¿®æ”¹ | é›†æˆ Agent æ¨¡å¼ |

---

## ğŸš€ å¦‚ä½•å¯åŠ¨å’Œæµ‹è¯•

### 1. å¯åŠ¨æœåŠ¡

```bash
# ç¡®ä¿åç«¯æœåŠ¡è¿è¡Œ
make start

# å‰ç«¯åº”è¯¥å·²ç»å¯åŠ¨ï¼Œå¦‚æœæ²¡æœ‰ï¼š
cd web && npm run dev
```

### 2. æµ‹è¯•æ­¥éª¤

1. æ‰“å¼€æµè§ˆå™¨è®¿é—® `http://localhost:25173`
2. è¿›å…¥ AI Chat é¡µé¢
3. ç‚¹å‡»æ—¥ç¨‹å›¾æ ‡æˆ– "+" æŒ‰é’®
4. ç¡®ä¿"ä½¿ç”¨æ™ºèƒ½ Agent è§£æ"å¼€å…³å¼€å¯
5. è¾“å…¥ï¼š`æ˜å¤©ä¸‹åˆ3ç‚¹å’Œäº§å“å›¢é˜Ÿå¼€ä¼š`
6. ç‚¹å‡»"æ™ºèƒ½è§£æ"æŒ‰é’®
7. ç­‰å¾…å¤„ç†å®Œæˆï¼ŒæŸ¥çœ‹ Agent å“åº”
8. ç‚¹å‡»"åˆ·æ–°æ—¥ç¨‹"æŸ¥çœ‹æ–°åˆ›å»ºçš„æ—¥ç¨‹

### 3. æµ‹è¯•æŸ¥è¯¢åŠŸèƒ½

è¾“å…¥ï¼š`æŸ¥çœ‹æœ¬å‘¨æœ‰å“ªäº›æ—¥ç¨‹`
- Agent ä¼šè°ƒç”¨æŸ¥è¯¢å·¥å…·
- è¿”å›æœ¬å‘¨çš„æ—¥ç¨‹åˆ—è¡¨

---

## âš™ï¸ é…ç½®è¯´æ˜

### é»˜è®¤è¡Œä¸º

- **æ–°å»ºæ—¥ç¨‹**ï¼šé»˜è®¤å¼€å¯æ™ºèƒ½ Agent æ¨¡å¼
- **ç¼–è¾‘æ—¥ç¨‹**ï¼šä½¿ç”¨ä¼ ç»Ÿè¡¨å•ç¼–è¾‘ï¼ˆä¸æ¶‰åŠ Agentï¼‰

### æ—¶åŒºè®¾ç½®

Agent ä¼šè‡ªåŠ¨ä½¿ç”¨æµè§ˆå™¨çš„æ—¶åŒºè®¾ç½®ï¼š

```typescript
userTimezone: Intl.DateTimeFormat().resolvedOptions().timeZone || "Asia/Shanghai"
```

### å¼€å…³æ§åˆ¶

ç”¨æˆ·å¯ä»¥éšæ—¶åˆ‡æ¢ï¼š
- **Agent æ¨¡å¼**ï¼šæ™ºèƒ½ä½†ç¨æ…¢ï¼ˆéœ€è¦ LLM è°ƒç”¨ï¼‰
- **ä¼ ç»Ÿæ¨¡å¼**ï¼šå¿«é€Ÿä½†åŠŸèƒ½æœ‰é™

---

## ğŸ› æ•…éšœæ’é™¤

### é—®é¢˜ 1: Agent æ¨¡å¼æ— æ³•ä½¿ç”¨

**ç—‡çŠ¶**ï¼šç‚¹å‡»"æ™ºèƒ½è§£æ"åæ²¡æœ‰å“åº”

**æ£€æŸ¥**ï¼š
1. ç¡®è®¤åç«¯ AI åŠŸèƒ½å·²å¯ç”¨
2. ç¡®è®¤æœ‰å¯ç”¨çš„ LLM provider
3. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ£€æŸ¥ç¯å¢ƒå˜é‡
cat .env | grep AI

# åº”è¯¥çœ‹åˆ°ï¼š
# MEMOS_AI_ENABLED=true
# MEMOS_AI_LLM_PROVIDER=deepseek
# MEMOS_AI_DEEPSEEK_API_KEY=your_key
```

### é—®é¢˜ 2: Agent è§£æå¤±è´¥

**ç—‡çŠ¶**ï¼šæ˜¾ç¤º"æ™ºèƒ½è§£æå¤±è´¥"

**å¯èƒ½åŸå› **ï¼š
1. LLM API è°ƒç”¨å¤±è´¥
2. è¾“å…¥æ ¼å¼ä¸è¢«ç†è§£
3. ç½‘ç»œé—®é¢˜

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ç‚¹å‡»å¼€å…³åˆ‡æ¢åˆ°ä¼ ç»Ÿæ¨¡å¼
- æ£€æŸ¥ç½‘ç»œè¿æ¥
- ç®€åŒ–è¾“å…¥è¡¨è¾¾

### é—®é¢˜ 3: åˆ›å»ºçš„æ—¥ç¨‹æœªæ˜¾ç¤º

**ç—‡çŠ¶**ï¼šAgent è¯´åˆ›å»ºæˆåŠŸï¼Œä½†åˆ—è¡¨ä¸­çœ‹ä¸åˆ°

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ç‚¹å‡»"åˆ·æ–°æ—¥ç¨‹"æŒ‰é’®
2. æˆ–å…³é—­å¯¹è¯æ¡†é‡æ–°æ‰“å¼€

---

## ğŸ“Š æŠ€æœ¯ç»†èŠ‚

### Agent API è°ƒç”¨æµç¨‹

```typescript
// 1. å‰ç«¯è°ƒç”¨
scheduleAgentServiceClient.chat({
  message: "æ˜å¤©ä¸‹åˆ3ç‚¹å¼€ä¼š",
  userTimezone: "Asia/Shanghai"
})

// 2. åç«¯å¤„ç†
ScheduleAgentService.Chat()
  â†’ SchedulerAgent.Execute()
  â†’ Agent è°ƒç”¨å·¥å…·
  â†’ è¿”å›å“åº”

// 3. å‰ç«¯æ˜¾ç¤º
setAgentResponse(result.response)
```

### äº‹ä»¶æµï¼ˆå¯é€‰æ‰©å±•ï¼‰

å¦‚æœéœ€è¦å®æ—¶åé¦ˆï¼Œå¯ä»¥ä½¿ç”¨æµå¼ APIï¼š

```typescript
import { scheduleAgentChatStream } from "@/hooks/useScheduleAgent";

async function* streamAgentResponse(message: string) {
  for await (const event of await scheduleAgentChatStream(message)) {
    if (event.type === "thinking") {
      console.log("Agent is thinking...");
    } else if (event.type === "tool_use") {
      console.log("Using tool:", event.data);
    } else if (event.type === "answer") {
      console.log("Final answer:", event.data);
    }
  }
}
```

---

## ğŸ‰ æ€»ç»“

æ–°ç‰ˆ Agent å·²æˆåŠŸé›†æˆåˆ°å‰ç«¯æ—¥ç¨‹åˆ›å»ºåŠŸèƒ½ä¸­ï¼

### æ ¸å¿ƒæ”¹è¿›

- âœ… æ”¯æŒæŸ¥è¯¢å’Œåˆ›å»ºä¸¤ç§æ“ä½œ
- âœ… æ›´æ™ºèƒ½çš„è‡ªç„¶è¯­è¨€ç†è§£
- âœ… ä¿ç•™ä¼ ç»Ÿæ¨¡å¼ä½œä¸ºå¤‡é€‰
- âœ… ç”¨æˆ·å¯è‡ªç”±åˆ‡æ¢

### ä½¿ç”¨å»ºè®®

1. **æ—¥å¸¸ä½¿ç”¨**ï¼šä¿æŒ Agent æ¨¡å¼å¼€å¯ï¼Œäº«å—æ™ºèƒ½ä½“éªŒ
2. **ç½‘ç»œé—®é¢˜**ï¼šåˆ‡æ¢åˆ°ä¼ ç»Ÿæ¨¡å¼
3. **ç®€å•åˆ›å»º**ï¼šä¸¤ç§æ¨¡å¼éƒ½èƒ½å¾ˆå¥½åœ°å¤„ç†

### æœªæ¥ä¼˜åŒ–æ–¹å‘

- [ ] æ·»åŠ æµå¼å“åº”æ”¯æŒ
- [ ] æ”¯æŒå¤šè½®å¯¹è¯ä¼˜åŒ–åˆ›å»º
- [ ] æ·»åŠ æ›´å¤šçš„å·¥å…·ï¼ˆå¦‚æ›´æ–°ã€åˆ é™¤ï¼‰
- [ ] ä¼˜åŒ–é”™è¯¯æç¤ºå’Œå¼•å¯¼

---

**äº«å—æ™ºèƒ½æ—¥ç¨‹ç®¡ç†ï¼** ğŸŠ
