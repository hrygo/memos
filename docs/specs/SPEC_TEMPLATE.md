# Spec 编写模板

> 本模板用于编写原子化功能规范文档。请按照以下结构填写。

---

```markdown
# {Spec ID}: {功能名称}

> **状态**: 🔲 待开发 | 🔄 开发中 | ✅ 已完成 | ❌ 已废弃  
> **优先级**: P0 (核心) | P1 (重要) | P2 (增强) | P3 (可选)  
> **投入**: {n}人天  
> **负责团队**: 团队 A/B/C  
> **Sprint**: Sprint {n}

---

## 1. 目标与背景

### 1.1 核心目标

一句话描述此 Spec 要解决的问题。

### 1.2 用户价值

- 对用户的直接影响点 1
- 对用户的直接影响点 2

### 1.3 技术价值

- 对系统架构的改进点 1
- 对系统架构的改进点 2

---

## 2. 依赖关系

### 2.1 前置依赖（必须完成）

- [ ] {Spec ID}: {简述}

### 2.2 并行依赖（可同步进行）

- [ ] {Spec ID}: {简述}

### 2.3 后续依赖（依赖本 Spec）

- {Spec ID}: {简述}

---

## 3. 功能设计

### 3.1 架构图

```
[ASCII 架构图或描述]
```

### 3.2 核心流程

1. 步骤1: 描述
2. 步骤2: 描述
3. 步骤3: 描述

### 3.3 关键决策

| 决策点 | 方案 A | 方案 B | 选择 | 理由 |
|:---|:---|:---|:---:|:---|
| 决策1 | 方案描述 | 方案描述 | A/B | 选择理由 |

---

## 4. 技术实现

### 4.1 接口定义

```go
// 核心接口签名
type SomeService interface {
    Method(ctx context.Context, input Input) (Output, error)
}
```

### 4.2 数据模型

```go
// 数据结构定义
type SomeModel struct {
    ID        int64     `json:"id"`
    CreatedAt time.Time `json:"created_at"`
}
```

```sql
-- 数据库表定义（如需要）
CREATE TABLE some_table (
    id SERIAL PRIMARY KEY,
    created_at TIMESTAMP DEFAULT NOW()
);
```

### 4.3 关键代码路径

| 文件路径 | 职责 |
|:---|:---|
| `plugin/ai/xxx/service.go` | 核心服务实现 |
| `server/router/api/v1/xxx.go` | API 处理器 |
| `web/src/components/Xxx.tsx` | 前端组件 |

---

## 5. 交付物清单

### 5.1 代码文件

- [ ] `path/to/file1.go` - 功能说明
- [ ] `path/to/file2.tsx` - 功能说明

### 5.2 数据库变更

- [ ] Migration: `store/db/postgres/migration/xxx.sql` - 变更说明

### 5.3 配置变更

- [ ] `.env.example` - 新增配置项: `MEMOS_XXX=value`

### 5.4 文档更新

- [ ] `docs/dev-guides/XXX.md` - 更新内容说明

---

## 6. 测试验收

### 6.1 功能测试

| 场景 | 输入 | 预期输出 |
|:---|:---|:---|
| 正常场景 | 输入描述 | 输出描述 |
| 边界场景 | 输入描述 | 输出描述 |
| 异常场景 | 输入描述 | 输出描述 |

### 6.2 性能验收

| 指标 | 目标值 | 测试方法 |
|:---|:---|:---|
| 响应延迟 P50 | < 100ms | 压测工具 |
| 响应延迟 P95 | < 500ms | 压测工具 |
| 吞吐量 | > 100 QPS | 压测工具 |

### 6.3 集成验收

- [ ] 与 {Spec ID} 集成测试通过
- [ ] 端到端流程验证通过

---

## 7. ROI 分析

| 维度 | 值 |
|:---|:---|
| 开发投入 | {n}人天 |
| 预期收益 | 具体指标描述 |
| 风险评估 | 低/中/高 |
| 回报周期 | {时间} |

---

## 8. 风险与缓解

| 风险 | 概率 | 影响 | 缓解措施 |
|:---|:---:|:---:|:---|
| 风险1描述 | 低/中/高 | 低/中/高 | 缓解措施描述 |
| 风险2描述 | 低/中/高 | 低/中/高 | 缓解措施描述 |

---

## 9. 实施计划

### 9.1 时间表

| 阶段 | 时间 | 任务 |
|:---|:---|:---|
| Day 1-2 | 2人天 | 任务描述 |
| Day 3-4 | 2人天 | 任务描述 |

### 9.2 检查点

- [ ] Checkpoint 1: 里程碑描述
- [ ] Checkpoint 2: 里程碑描述

---

## 附录

### A. 参考资料

- [相关文档链接](./path/to/doc.md)
- [外部参考](https://example.com)

### B. 变更记录

| 日期 | 版本 | 变更内容 | 作者 |
|:---|:---|:---|:---|
| 2026-01-27 | v1.0 | 初始版本 | - |
```

---

## 命名规范

**Spec ID 格式**: `P{Phase}-{Team}{序号}-{功能简称}`

| 部分 | 说明 | 示例 |
|:---|:---|:---|
| `P{Phase}` | P1/P2/P3 对应阶段 | P1, P2, P3 |
| `{Team}` | A=公共服务, B=助理日程, C=笔记增强 | A, B, C |
| `{序号}` | 001-999 递增 | 001, 002 |
| `{功能简称}` | kebab-case 英文 | memory-system |

**示例**:
- `P1-A001-memory-system` - Phase 1 团队A 记忆系统
- `P2-B001-habit-learner` - Phase 2 团队B 习惯学习
- `P3-C001-knowledge-graph` - Phase 3 团队C 知识图谱

---

## 状态标记

| 状态 | 标记 | 说明 |
|:---|:---:|:---|
| 待开发 | 🔲 | Spec 已定义，等待开发 |
| 开发中 | 🔄 | 正在开发中 |
| 已完成 | ✅ | 开发完成并通过验收 |
| 已废弃 | ❌ | 需求变更或取消 |

---

## 优先级定义

| 优先级 | 说明 | 决策依据 |
|:---|:---|:---|
| **P0** | 核心功能，必须完成 | 阻塞其他功能或影响核心体验 |
| **P1** | 重要功能，应该完成 | 显著提升用户价值 |
| **P2** | 增强功能，可以完成 | 锦上添花，差异化竞争 |
| **P3** | 可选功能，时间允许 | 长期价值，非当前重点 |
