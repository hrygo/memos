# Memos 笔记功能 AI 增强调研报告

> **调研日期**: 2026-01-27  
> **定位**: 隐私优先的私人笔记软件  
> **范围**: 笔记本身能力的 AI 增强（智能助理、日程管理由其他团队负责）

**文档导航**: [主路线图](./00-master-roadmap.md) | [实施路线图](./memo-roadmap.md)

---

## 一、产品定位与核心价值

### 1.1 Memos 定位

```
┌─────────────────────────────────────────────────────────────────┐
│                      私人笔记软件定位                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│   核心用户画像:                                                  │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │  • 注重隐私的个人用户                                     │   │
│   │  • 需要快速记录碎片化想法                                 │   │
│   │  • 希望从历史笔记中快速找到信息                           │   │
│   │  • 自托管偏好者（开发者、技术人员）                       │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│   核心价值主张:                                                  │
│   ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐       │
│   │ 隐私优先 │  │ 快速记录 │  │ 智能检索 │  │ 自托管   │       │
│   │ 数据私有 │  │ 打开即写 │  │ 语义搜索 │  │ 完全控制 │       │
│   └──────────┘  └──────────┘  └──────────┘  └──────────┘       │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 1.2 与团队产品的边界

| 模块 | 负责团队 | 本文档范围 |
|:---|:---|:---:|
| **笔记 AI 增强** | 本团队 | ✅ |
| **智能助理 (Parrot Agents)** | 其他团队 | ❌ |
| **日程管理** | 其他团队 | ❌ |

---

## 二、竞品调研

### 2.1 主流笔记软件 AI 能力矩阵

| 产品 | 定位 | AI 能力 | 隐私性 | 开源 |
|:---|:---|:---|:---:|:---:|
| **Notion** | 团队协作 Wiki | AI 写作、摘要、翻译、Q&A | ❌ 云端 | ❌ |
| **Obsidian** | 本地 Markdown | 插件生态 (Copilot/Smart Connections) | ✅ 本地 | ❌ |
| **Logseq** | 大纲+双链 | Copilot 插件、知识图谱 | ✅ 本地 | ✅ |
| **Roam Research** | 网状思维 | Live AI Assistant、Operator Agent | ❌ 云端 | ❌ |
| **Apple Notes** | 系统原生 | Apple Intelligence (摘要/重写) | ✅ 设备端 | ❌ |
| **Mem** | AI-first | 自动整理、相关建议、智能搜索 | ❌ 云端 | ❌ |
| **Memos** | 私人备忘 | 语义搜索、AI 对话 | ✅ 自托管 | ✅ |

### 2.2 竞品 AI 功能深度分析

#### Notion AI

```
┌─────────────────────────────────────────────────────────────────┐
│                       Notion AI 功能                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  写作类 (非本项目方向):                                          │
│  ├─ 续写、改写、总结、翻译                                       │
│  └─ 头脑风暴、大纲生成                                           │
│                                                                 │
│  知识检索类 (可借鉴):                                            │
│  ├─ Q&A: 基于工作区内容回答问题                                  │
│  ├─ 相关页面推荐                                                 │
│  └─ 自动填充数据库属性                                           │
│                                                                 │
│  自动化类 (可借鉴):                                              │
│  ├─ 自动生成摘要                                                 │
│  └─ 智能标签/分类建议                                            │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

#### Obsidian + AI 插件生态

```
┌─────────────────────────────────────────────────────────────────┐
│                    Obsidian AI 插件生态                          │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  Smart Connections:                                             │
│  ├─ 本地向量索引 (隐私友好)                                      │
│  ├─ 相似笔记推荐                                                 │
│  ├─ 基于笔记的 AI 对话                                          │
│  └─ 块级别语义搜索                                               │
│                                                                 │
│  Copilot:                                                       │
│  ├─ 多模型支持 (OpenAI/Ollama/Local)                            │
│  ├─ RAG 检索增强对话                                            │
│  └─ 自定义 Prompt 模板                                          │
│                                                                 │
│  核心差异化:                                                     │
│  ✅ 本地优先，支持离线                                           │
│  ✅ 用户可选择模型提供商                                         │
│  ✅ 与双链/图谱深度集成                                          │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

#### Mem (AI-First 代表)

```
┌─────────────────────────────────────────────────────────────────┐
│                      Mem AI-Native 设计                          │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  核心理念: "笔记应该像记忆一样工作"                               │
│                                                                 │
│  自动整理:                                                       │
│  ├─ 无需手动分类，AI 自动建立关联                                │
│  ├─ 时间衰减 + 语义相关性排序                                    │
│  └─ 智能浮现 (Surface) 相关旧笔记                                │
│                                                                 │
│  智能搜索:                                                       │
│  ├─ 自然语言查询 ("上周关于项目预算的讨论")                       │
│  ├─ 多维度过滤 (时间/人物/主题)                                  │
│  └─ 搜索结果高亮 + 上下文摘录                                    │
│                                                                 │
│  主动推送:                                                       │
│  ├─ 写作时推荐相关旧笔记                                         │
│  └─ 每日智能摘要                                                 │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 2.3 竞品能力对比总结

```
                    AI 能力成熟度
                         ↑
            Notion AI    │    Mem
            (全面但云端)  │    (AI-Native)
                         │
         ─────────────────┼─────────────────→ 隐私性
                         │
         Obsidian+插件    │    Memos (当前)
         (本地+可选)      │    (自托管+基础AI)
                         │
```

**Memos 的机会点**: 在"隐私优先"象限中，提供接近 Notion/Mem 水平的 AI 能力。

---

## 三、私人笔记场景核心需求分析

### 3.1 用户旅程与痛点

```
┌─────────────────────────────────────────────────────────────────┐
│                      私人笔记用户旅程                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  1. 快速记录                                                     │
│     用户行为: 打开 App → 快速输入 → 保存                         │
│     当前体验: ✅ 优秀 (打开即写)                                 │
│     痛点: ⚠️ 标签需手动输入，容易忘记或不一致                    │
│                                                                 │
│  2. 整理归档                                                     │
│     用户行为: 浏览笔记 → 添加标签 → 建立关联                     │
│     当前体验: ⚠️ 一般 (纯手动)                                  │
│     痛点: ❌ 无自动分类建议，无相关笔记推荐                      │
│                                                                 │
│  3. 查找回顾                                                     │
│     用户行为: 输入关键词 → 浏览结果 → 定位内容                   │
│     当前体验: ✅ 良好 (语义搜索)                                 │
│     痛点: ⚠️ 结果无高亮，长笔记难定位                           │
│                                                                 │
│  4. 知识沉淀                                                     │
│     用户行为: 关联笔记 → 形成知识体系 → 周期回顾                 │
│     当前体验: ❌ 缺失                                            │
│     痛点: ❌ 无知识图谱，无智能回顾提醒                          │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 3.2 私人笔记 vs 团队协作需求差异

| 维度 | 私人笔记 (Memos) | 团队协作 (Notion) |
|:---|:---|:---|
| **分类方式** | 标签为主，简单扁平 | 数据库、多级目录 |
| **搜索需求** | "我之前记过什么" | "团队里谁写过" |
| **关联需求** | 个人知识图谱 | 跨人员协作链接 |
| **回顾需求** | 定期自我复盘 | 项目进度追踪 |
| **隐私需求** | 极高 (个人日记/想法) | 相对低 (团队公开) |

---

## 四、Memos 笔记功能现状

### 4.1 系统架构 (笔记相关)

```
┌─────────────────────────────────────────────────────────────────┐
│                      笔记功能架构                                │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  前端层:                                                         │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐             │
│  │ MemoEditor  │  │  MemoView   │  │ PagedList   │             │
│  │ (创建/编辑) │  │  (展示)      │  │ (列表)      │             │
│  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘             │
│         └────────────────┴────────────────┘                     │
│                          │                                       │
│                   Connect RPC                                    │
│                          │                                       │
│  后端层:                                                         │
│  ┌─────────────────────────────────────────────────────────────┐│
│  │  memo_service.go                                             ││
│  │  ├─ CreateMemo (创建)                                        ││
│  │  ├─ ListMemos (列表+过滤)                                    ││
│  │  ├─ UpdateMemo (更新)                                        ││
│  │  └─ DeleteMemo (删除)                                        ││
│  └─────────────────────────────────────────────────────────────┘│
│                          │                                       │
│  AI 增强层:                                                      │
│  ┌─────────────────────────────────────────────────────────────┐│
│  │  Embedding Runner (异步向量化)                                ││
│  │  AdaptiveRetriever (混合检索: BM25 + Vector + Reranker)       ││
│  └─────────────────────────────────────────────────────────────┘│
│                          │                                       │
│  存储层:                                                         │
│  ┌─────────────────────────────────────────────────────────────┐│
│  │  PostgreSQL                                                  ││
│  │  ├─ memo 表 (内容、标签、时间戳)                              ││
│  │  ├─ memo_embedding 表 (向量索引)                              ││
│  │  └─ attachment 表 (附件)                                      ││
│  └─────────────────────────────────────────────────────────────┘│
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 4.2 数据模型

```go
// store/memo.go
type Memo struct {
    ID         int32                 // 唯一标识
    UID        string                // 用户可读 ID
    Content    string                // Markdown 内容
    Visibility Visibility            // PUBLIC/PROTECTED/PRIVATE
    Pinned     bool                  // 置顶
    Payload    *storepb.MemoPayload  // 解析后的元数据
    // Payload 包含:
    //   - Tags []string        // 标签列表
    //   - Links []Link         // 提取的链接
    //   - HasTaskList bool     // 是否含任务列表
}
```

### 4.3 现有 AI 能力评估

| 能力 | 状态 | 评分 | 说明 |
|:---|:---:|:---:|:---|
| **语义搜索** | ✅ 已实现 | 8/10 | 混合 RAG (BM25 + Vector + Reranker) |
| **向量索引** | ✅ 已实现 | 8/10 | pgvector + HNSW |
| **智能标签** | ⚠️ 部分 | 4/10 | 仅有建议弹窗，未完善 |
| **相关推荐** | ❌ 缺失 | 0/10 | 无相似笔记推荐 |
| **自动摘要** | ❌ 缺失 | 0/10 | 长笔记无摘要 |
| **知识图谱** | ❌ 缺失 | 0/10 | 无可视化关联 |
| **搜索高亮** | ❌ 缺失 | 0/10 | 结果无关键词高亮 |

---

## 五、AI 增强产品规划

### 5.1 产品演进路线图

```
┌─────────────────────────────────────────────────────────────────┐
│                      产品演进三阶段                              │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  Phase 1: 智能检索增强                                           │
│  ┌─────────────────────────────────────────────────────────────┐│
│  │  目标: 让用户更快找到需要的笔记                               ││
│  │  ┌──────────┐  ┌──────────┐  ┌──────────┐                   ││
│  │  │搜索高亮  │  │上下文摘录│  │相关笔记  │                   ││
│  │  │匹配定位  │  │智能截取  │  │  推荐    │                   ││
│  │  └──────────┘  └──────────┘  └──────────┘                   ││
│  └─────────────────────────────────────────────────────────────┘│
│                            ↓                                     │
│  Phase 2: 智能整理组织                                           │
│  ┌─────────────────────────────────────────────────────────────┐│
│  │  目标: 减少用户整理负担                                       ││
│  │  ┌──────────┐  ┌──────────┐  ┌──────────┐                   ││
│  │  │智能标签  │  │自动分类  │  │重复检测  │                   ││
│  │  │  建议    │  │  建议    │  │  合并    │                   ││
│  │  └──────────┘  └──────────┘  └──────────┘                   ││
│  └─────────────────────────────────────────────────────────────┘│
│                            ↓                                     │
│  Phase 3: 知识沉淀回顾                                           │
│  ┌─────────────────────────────────────────────────────────────┐│
│  │  目标: 帮助用户建立个人知识体系                               ││
│  │  ┌──────────┐  ┌──────────┐  ┌──────────┐                   ││
│  │  │知识图谱  │  │智能回顾  │  │每日摘要  │                   ││
│  │  │ 可视化   │  │  提醒    │  │  推送    │                   ││
│  │  └──────────┘  └──────────┘  └──────────┘                   ││
│  └─────────────────────────────────────────────────────────────┘│
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 5.2 Phase 1: 智能检索增强 (P0/P1)

#### 5.2.1 搜索结果高亮

**用户价值**: 快速定位搜索匹配位置，减少阅读负担

```
┌─────────────────────────────────────────────────────────────────┐
│                     搜索高亮设计                                 │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  搜索: "React hooks 状态管理"                                    │
│                                                                 │
│  改进前:                                                         │
│  ┌─────────────────────────────────────────────────────────────┐│
│  │ 今天学习了 React 的 useState 和 useEffect，这些 hooks       ││
│  │ 让函数组件也能管理状态。下午还研究了 Redux 和 Zustand...     ││
│  │ (完整笔记，无高亮，需要用户自己找)                            ││
│  └─────────────────────────────────────────────────────────────┘│
│                                                                 │
│  改进后:                                                         │
│  ┌─────────────────────────────────────────────────────────────┐│
│  │ ...学习了 [React] 的 useState 和 useEffect，这些 [hooks]    ││
│  │ 让函数组件也能 [管理] [状态]...                              ││
│  │                                                             ││
│  │ 匹配度: 92%  │  2024-01-15  │  #技术 #前端                  ││
│  │                                        [查看完整笔记 →]      ││
│  └─────────────────────────────────────────────────────────────┘│
│                                                                 │
│  技术方案:                                                       │
│  1. 后端: 返回匹配片段 + 位置信息                                │
│  2. 前端: 使用 <mark> 标签高亮                                   │
│  3. 长笔记: 智能截取匹配上下文 (前后各 50 字)                    │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

**实现优先级**: P0
**预期效果**: 搜索效率提升 50%+

#### 5.2.2 相关笔记推荐

**用户价值**: 写作时自动浮现相关旧笔记，增强知识关联

```
┌─────────────────────────────────────────────────────────────────┐
│                   相关笔记推荐设计                               │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  触发场景:                                                       │
│  1. 编辑器输入时 (实时推荐)                                      │
│  2. 笔记详情页侧边栏 (静态推荐)                                  │
│  3. 保存笔记后 (推送通知)                                        │
│                                                                 │
│  UI 设计 (编辑器侧边):                                           │
│  ┌─────────────────────────────────────────────────────────────┐│
│  │  正在编辑...                      │  相关笔记              ││
│  │  ┌───────────────────────────────┐│  ┌──────────────────┐ ││
│  │  │ 今天研究了 React 18 的        ││  │ React 性能优化   │ ││
│  │  │ Concurrent 特性，感觉和之前    ││  │ 相似度: 87%      │ ││
│  │  │ 的 Fiber 架构有关联...        ││  └──────────────────┘ ││
│  │  │                               ││  ┌──────────────────┐ ││
│  │  │                               ││  │ Fiber 架构笔记   │ ││
│  │  │                               ││  │ 相似度: 82%      │ ││
│  │  └───────────────────────────────┘│  └──────────────────┘ ││
│  └─────────────────────────────────────────────────────────────┘│
│                                                                 │
│  算法:                                                           │
│  1. 实时: 取最近输入的句子，向量检索 Top-5                       │
│  2. 静态: 全文向量 + 标签共现 + 时间邻近                         │
│  3. 去重: 排除已引用的笔记                                       │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

**实现优先级**: P1
**预期效果**: 笔记关联度提升，减少重复记录

#### 5.2.3 上下文智能摘录

**用户价值**: 长笔记搜索结果自动截取最相关片段

```
┌─────────────────────────────────────────────────────────────────┐
│                   智能摘录算法                                   │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  输入: 2000 字长笔记 + 搜索词 "数据库索引"                       │
│                                                                 │
│  处理流程:                                                       │
│  1. 分句/分段                                                    │
│  2. 计算每段与查询的相似度                                       │
│  3. 选取 Top-2 最相关段落                                        │
│  4. 拼接 + 省略号处理                                            │
│                                                                 │
│  输出:                                                           │
│  ┌─────────────────────────────────────────────────────────────┐│
│  │ ...B+树是 [数据库索引] 最常用的结构，它的特点是...            ││
│  │ ...建议在高基数列上创建 [索引]，避免全表扫描...               ││
│  └─────────────────────────────────────────────────────────────┘│
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

**实现优先级**: P1

### 5.3 Phase 2: 智能整理组织 (P1/P2)

#### 5.3.1 智能标签建议

**用户价值**: 减少标签输入负担，保持标签一致性

```
┌─────────────────────────────────────────────────────────────────┐
│                   智能标签建议                                   │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  三层建议策略:                                                   │
│                                                                 │
│  L1: 统计优先 (0ms, 本地)                                        │
│  ├─ 用户历史高频标签                                             │
│  ├─ 最近使用标签                                                 │
│  └─ 相似笔记标签                                                 │
│                                                                 │
│  L2: 规则提取 (10ms, 本地)                                       │
│  ├─ 专有名词识别 (React, Python, ...)                            │
│  ├─ 日期/时间模式 (#2024-01, #Q1)                                │
│  └─ 情感词 (#灵感, #问题, #待办)                                 │
│                                                                 │
│  L3: LLM 语义 (300ms, 可选)                                      │
│  ├─ 主题分类 (#技术, #生活, #工作)                               │
│  └─ 新标签发现                                                   │
│                                                                 │
│  UI 交互:                                                        │
│  ┌─────────────────────────────────────────────────────────────┐│
│  │  笔记内容...                                                 ││
│  │                                                             ││
│  │  建议标签: [#React] [#前端] [#学习笔记] [+ 自定义]           ││
│  │            ↑点击添加                                         ││
│  └─────────────────────────────────────────────────────────────┘│
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

**实现优先级**: P1
**现有基础**: `AITagSuggestPopover.tsx` 已存在，需完善后端

#### 5.3.2 自动分类建议

**用户价值**: 新笔记自动归类，减少整理时间

```
┌─────────────────────────────────────────────────────────────────┐
│                   自动分类建议                                   │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  场景: 用户有 500 条笔记，创建新笔记时自动建议分类                │
│                                                                 │
│  分类维度:                                                       │
│  1. 主题分类 (技术/生活/工作/学习...)                            │
│  2. 项目分类 (项目A/项目B/...)                                   │
│  3. 时间分类 (日记/周报/临时...)                                 │
│                                                                 │
│  实现方式:                                                       │
│  1. 聚类分析: 对所有笔记向量聚类，识别自然分组                   │
│  2. 新笔记: 计算与各聚类中心的距离                               │
│  3. 推荐: 展示最近的 2-3 个分类                                  │
│                                                                 │
│  注意: 私人笔记场景，分类应该简单、非强制                        │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

**实现优先级**: P2

#### 5.3.3 重复/相似笔记检测

**用户价值**: 避免重复记录，合并碎片笔记

```
┌─────────────────────────────────────────────────────────────────┐
│                   重复检测设计                                   │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  检测时机:                                                       │
│  1. 创建新笔记时 (实时)                                          │
│  2. 周期性扫描 (后台)                                            │
│                                                                 │
│  检测规则:                                                       │
│  ├─ 高相似度 (>90%): 可能重复，提示合并                          │
│  ├─ 中相似度 (70-90%): 相关内容，建议关联                        │
│  └─ 低相似度 (<70%): 正常，不提示                                │
│                                                                 │
│  用户交互:                                                       │
│  ┌─────────────────────────────────────────────────────────────┐│
│  │  ⚠️ 发现相似笔记                                            ││
│  │  ┌─────────────────────────────────────────────────────────┐││
│  │  │ 当前: React 状态管理学习笔记                            │││
│  │  │ 相似: React useState 使用心得 (相似度: 92%)             │││
│  │  │                                                         │││
│  │  │ [合并] [关联] [忽略]                                    │││
│  │  └─────────────────────────────────────────────────────────┘││
│  └─────────────────────────────────────────────────────────────┘│
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

**实现优先级**: P2

### 5.4 Phase 3: 知识沉淀回顾 (P2/P3)

#### 5.4.1 知识图谱可视化

**用户价值**: 直观展示笔记间关系，发现知识盲点

```
┌─────────────────────────────────────────────────────────────────┐
│                   知识图谱设计                                   │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  节点类型:                                                       │
│  ○ 笔记节点 (大小 = 关联数)                                      │
│  ● 标签节点 (颜色 = 分类)                                        │
│                                                                 │
│  边类型:                                                         │
│  ── 手动关联 (实线)                                              │
│  -- 语义相似 (虚线，阈值可调)                                    │
│  ── 标签共现 (点线)                                              │
│                                                                 │
│  交互:                                                           │
│  1. 悬停: 显示笔记预览                                           │
│  2. 点击: 跳转笔记详情                                           │
│  3. 拖拽: 调整布局                                               │
│  4. 筛选: 按时间/标签过滤                                        │
│                                                                 │
│  可视化示例:                                                     │
│                     ┌─────┐                                      │
│              ┌──────┤React├──────┐                               │
│              │      └─────┘      │                               │
│         ┌────┴────┐         ┌────┴────┐                          │
│         │性能优化 │─ ─ ─ ─ ─│Hooks笔记│                          │
│         └────┬────┘         └────┬────┘                          │
│              │                   │                               │
│         ┌────┴────┐         ┌────┴────┐                          │
│         │虚拟列表 │         │useState │                          │
│         └─────────┘         └─────────┘                          │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

**实现优先级**: P2
**技术选型**: D3.js / vis.js / Cytoscape.js

#### 5.4.2 智能回顾提醒

**用户价值**: 定期复习，强化记忆

```
┌─────────────────────────────────────────────────────────────────┐
│                   智能回顾设计                                   │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  回顾算法 (借鉴间隔重复):                                        │
│  1. 新笔记: 1天后、3天后、7天后、30天后提醒                      │
│  2. 重要笔记: 用户标记，提高回顾频率                             │
│  3. 衰减笔记: 长期未访问，偶尔浮现                               │
│                                                                 │
│  触发方式:                                                       │
│  1. 每日摘要邮件/通知 (可选)                                     │
│  2. 首页"今日回顾"卡片                                          │
│  3. 随机浮现 (打开 App 时)                                       │
│                                                                 │
│  UI 设计:                                                        │
│  ┌─────────────────────────────────────────────────────────────┐│
│  │  📅 今日回顾                                                 ││
│  │  ┌─────────────────────────────────────────────────────────┐││
│  │  │ "React 性能优化笔记" (30天前创建)                        │││
│  │  │ ...虚拟列表可以显著提升长列表性能...                     │││
│  │  │                                                         │││
│  │  │ [已回顾 ✓] [稍后] [不再提醒]                            │││
│  │  └─────────────────────────────────────────────────────────┘││
│  └─────────────────────────────────────────────────────────────┘│
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

**实现优先级**: P3

#### 5.4.3 每日/每周智能摘要

**用户价值**: 自动总结记录内容，便于复盘

```
┌─────────────────────────────────────────────────────────────────┐
│                   智能摘要设计                                   │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  每日摘要 (本地生成):                                            │
│  ┌─────────────────────────────────────────────────────────────┐│
│  │  📝 2026-01-27 笔记摘要                                      ││
│  │                                                             ││
│  │  今日新增: 5 条笔记                                          ││
│  │  主要话题: #React #项目A #读书笔记                           ││
│  │                                                             ││
│  │  亮点笔记:                                                   ││
│  │  • React 18 并发特性学习 (最长)                              ││
│  │  • 项目 A 进度更新 (最多标签)                                ││
│  │                                                             ││
│  │  相关旧笔记被访问: 3 条                                      ││
│  └─────────────────────────────────────────────────────────────┘│
│                                                                 │
│  每周摘要 (可选 LLM 增强):                                       │
│  • 本周关键词云                                                  │
│  • 笔记趋势分析                                                  │
│  • 知识图谱增长                                                  │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

**实现优先级**: P3

---

## 六、技术实现方案

### 6.1 API 扩展设计

```protobuf
// proto/api/v1/ai_service.proto

service AIService {
  // 现有 (智能助理团队负责)
  rpc Chat(ChatRequest) returns (stream ChatResponse);
  
  // 新增: 笔记 AI 增强 (本团队负责)
  
  // Phase 1: 智能检索
  rpc SearchWithHighlight(SearchWithHighlightRequest) 
      returns (SearchWithHighlightResponse);
  rpc GetRelatedMemos(GetRelatedMemosRequest) 
      returns (GetRelatedMemosResponse);
  
  // Phase 2: 智能整理
  rpc SuggestTags(SuggestTagsRequest) 
      returns (SuggestTagsResponse);
  rpc DetectDuplicates(DetectDuplicatesRequest) 
      returns (DetectDuplicatesResponse);
  
  // Phase 3: 知识沉淀
  rpc GetKnowledgeGraph(GetKnowledgeGraphRequest) 
      returns (GetKnowledgeGraphResponse);
  rpc GetReviewSuggestions(GetReviewSuggestionsRequest) 
      returns (GetReviewSuggestionsResponse);
}

message SearchWithHighlightRequest {
  string query = 1;
  int32 limit = 2;
  int32 context_chars = 3;  // 上下文字符数
}

message SearchWithHighlightResponse {
  repeated HighlightedMemo memos = 1;
}

message HighlightedMemo {
  string name = 1;
  string snippet = 2;           // 高亮摘录
  repeated Highlight highlights = 3;  // 高亮位置
  float score = 4;
}

message Highlight {
  int32 start = 1;
  int32 end = 2;
  string matched_text = 3;
}
```

### 6.2 前端组件规划

```
web/src/components/
├── MemoEditor/
│   └── components/
│       ├── AITagSuggestPopover.tsx  # 已存在，需完善
│       └── RelatedMemosPanel.tsx    # 新增: 相关笔记侧边栏
│
├── MemoSearch/
│   ├── HighlightedResult.tsx        # 新增: 高亮搜索结果
│   └── SearchSnippet.tsx            # 新增: 智能摘录
│
├── KnowledgeGraph/                   # 新增
│   ├── GraphCanvas.tsx              # 图谱画布
│   ├── NodeTooltip.tsx              # 节点悬停
│   └── FilterPanel.tsx              # 筛选面板
│
└── Review/                           # 新增
    ├── DailyReviewCard.tsx          # 每日回顾
    └── WeeklySummary.tsx            # 每周摘要
```

### 6.3 后端服务规划

```
server/
├── router/api/v1/
│   ├── memo_service.go              # 现有
│   └── memo_ai_service.go           # 新增: 笔记 AI 增强
│
└── service/memo/                     # 新增
    ├── highlight.go                 # 搜索高亮
    ├── related.go                   # 相关推荐
    ├── tags.go                      # 智能标签
    ├── duplicate.go                 # 重复检测
    ├── graph.go                     # 知识图谱
    └── review.go                    # 智能回顾
```

---

## 七、优先级与排期建议

### 7.1 功能优先级矩阵

```
                    用户价值 (高)
                         ↑
         搜索高亮 (P0)   │   相关推荐 (P1)
         智能标签 (P1)   │   
                         │
    ─────────────────────┼─────────────────→ 实现复杂度 (高)
                         │
         上下文摘录(P1)  │   知识图谱 (P2)
                         │   智能回顾 (P3)
                         │
```

### 7.2 实施路线图

```
┌─────────────────────────────────────────────────────────────────┐
│                      实施路线图                                  │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  Sprint 1-2 (Phase 1):                                          │
│  ┌─────────────────────────────────────────────────────────────┐│
│  │ ✅ P0: 搜索结果高亮                                          ││
│  │ ✅ P1: 上下文智能摘录                                        ││
│  │ ✅ P1: 相关笔记推荐 (侧边栏)                                 ││
│  └─────────────────────────────────────────────────────────────┘│
│                                                                 │
│  Sprint 3-4 (Phase 2):                                          │
│  ┌─────────────────────────────────────────────────────────────┐│
│  │ ✅ P1: 智能标签建议完善                                      ││
│  │ ○  P2: 重复/相似笔记检测                                     ││
│  │ ○  P2: 自动分类建议                                          ││
│  └─────────────────────────────────────────────────────────────┘│
│                                                                 │
│  Sprint 5+ (Phase 3):                                           │
│  ┌─────────────────────────────────────────────────────────────┐│
│  │ ○  P2: 知识图谱可视化                                        ││
│  │ ○  P3: 智能回顾提醒                                          ││
│  │ ○  P3: 每日/每周摘要                                         ││
│  └─────────────────────────────────────────────────────────────┘│
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 八、成功指标

| 阶段 | 指标 | 目标值 |
|:---|:---|:---|
| **Phase 1** | 搜索到目标笔记的平均点击次数 | 减少 50% |
| **Phase 1** | 相关笔记推荐点击率 | > 15% |
| **Phase 2** | 标签建议采纳率 | > 40% |
| **Phase 2** | 重复笔记合并率 | > 30% |
| **Phase 3** | 知识图谱周活跃用户 | > 20% DAU |
| **Phase 3** | 回顾功能完成率 | > 50% |

---

## 九、总结

### 9.1 核心结论

1. **定位清晰**: Memos 作为隐私优先的私人笔记软件，应聚焦"记录-整理-检索-沉淀"闭环
2. **竞品差距**: 与 Notion/Mem 相比，AI 整理和知识沉淀能力有明显差距
3. **机会窗口**: 在"隐私优先"象限提供媲美云端产品的 AI 能力，是明确的差异化方向

### 9.2 三大演进方向

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│  1. 从"搜索"到"发现"                                            │
│     高亮 → 摘录 → 相关推荐 → 主动浮现                            │
│                                                                 │
│  2. 从"手动"到"智能"                                            │
│     手动标签 → 智能建议 → 自动分类 → 重复合并                    │
│                                                                 │
│  3. 从"记录"到"沉淀"                                            │
│     碎片笔记 → 知识图谱 → 智能回顾 → 个人知识库                  │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 9.3 与其他团队协作边界

| 本团队 (笔记 AI) | 其他团队 |
|:---|:---|
| 搜索高亮、相关推荐 | AI 对话 (Parrot Agents) |
| 智能标签、自动分类 | 日程管理 |
| 知识图谱、智能回顾 | 智能助理 |

通过聚焦笔记本身的 AI 增强，Memos 将从一个"能用"的笔记工具，进化为真正的**隐私优先的 AI 个人知识管理系统**。
