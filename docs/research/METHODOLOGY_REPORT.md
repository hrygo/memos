# Memos AI 产品研发：人机协作方法论总结报告

> 
> **项目周期**: 2026-01-27  
> 
> **总投入**: 125 人天规划，117 人天执行（2 人天搁置）  
> 
> **实际耗时**: 约 5 小时（压缩比 1:572） 
> 
> **报告目的**: 供后来者参考的经验总结  
> 

---

## 执行摘要

本项目是人类产品负责人与 AI 虚拟团队（1 名 AI PM + 3 个功能团队）协作完成的一次完整 AI 产品迭代。人类提供高质量的产品调研与路线图，AI 执行具体开发任务。

**核心成果**:
- 交付 25 个功能模块（2 个搁置）
- 产出 56,790 行代码（含测试 11,300 行），删除 1,425 行
- 单元测试覆盖率: ≈ 50%
- 定义 7 个公共服务接口
- 4 个数据库迁移
- 完成率 92.6%

**关键洞察**: AI 不产生战略，执行战略。高质量的人类输入是 AI 效能的上限。

---

## 一、方法论框架

### 1.1 角色分工

```
┌──────────────────────────────────────────────────────────────────────┐
│                            人类产品负责人                              │
│  ┌────────────────────────────────────────────────────────────────┐  │
│  │ • 战略决策（如搁置本地模型功能）                                 │  │
│  │ • 调研输入（3 份调研报告 + 产品路线图）                           │  │
│  │ • 验收把关（任务完成确认、新任务请求）                            │  │
│  └────────────────────────────────────────────────────────────────┘  │
└──────────────────────────────────────────────────────────────────────┘
                                   │
                                   ▼
┌──────────────────────────────────────────────────────────────────────┐
│                            AI PM (Claude)                            │
│  ┌────────────────────────────────────────────────────────────────┐  │
│  │ • 任务调度：基于依赖图的并行任务分配                              │  │
│  │ • 状态管理：实时更新 INDEX.md + Spec 文档                        │  │
│  │ • 风险识别：依赖阻塞、资源冲突、搁置决策                          │  │
│  │ • 跨团队协调：状态变更通知、验收检查点                            │  │
│  └────────────────────────────────────────────────────────────────┘  │
└──────────────────────────────────────────────────────────────────────┘
                                   │
              ┌────────────────────┼────────────────────┐
              ▼                    ▼                    ▼
    ┌──────────────────┐  ┌──────────────────┐  ┌──────────────────┐
    │      Team A      │  │      Team B      │  │      Team C      │
    │     公共服务     │  │    助理+日程     │  │     笔记增强     │
    │                  │  │                  │  │                  │
    │  Memory/Router   │  │ Scheduler/Habit  │  │   Search/Tags    │
    │                  │  │                  │  │                  │
    │      8 任务      │  │     11 任务      │  │      8 任务      │
    │     25 人天      │  │     39 人天      │  │     53 人天      │
    └──────────────────┘  └──────────────────┘  └──────────────────┘
```

### 1.2 核心原则

| 原则             | 实践                         | 效果             |
| :--------------- | :--------------------------- | :--------------- |
| **依赖前置**     | Sprint 0 定义接口契约 + Mock | 三团队并行无阻塞 |
| **最小可行单元** | 任务粒度 1-9 人天            | 快速反馈、低风险 |
| **状态即文档**   | INDEX.md 实时更新            | 单一信息源       |
| **决策留痕**     | 搁置记录（P3-A001）          | 可追溯、可复盘   |

---

## 二、关键成功因素

### 2.1 高质量的人类输入

人类提供的三份调研报告构成了项目成功的基石：

| 文档             | 内容                         | 价值         |
| :--------------- | :--------------------------- | :----------- |
| **日程管理调研** | 功能边界、技术选型、架构设计 | 明确"做什么" |
| **笔记增强调研** | 向量检索、标签建议、竞品分析 | 明确"怎么做" |
| **产品路线图**   | 125 人天、3 Phase、6 Sprint  | 明确"何时做" |

**经验**: AI PM 不生成战略，执行战略。高质量的人类输入是 AI 效能的上限。

### 2.2 Sprint 0 契约模式

在进入功能开发前，先完成接口定义：

```go
// plugin/ai/memory/interface.go
type MemoryService interface {
    GetRecentMessages(ctx, sessionID, limit) ([]Message, error)
    AddMessage(ctx, sessionID, msg) error
    SaveEpisode(ctx, episode) error
    // ...
}

// plugin/ai/memory/mock.go
type MockMemoryService struct { ... }
```

**收益**:
- Team B/C 可立即使用 Mock 开发
- 接口变更通过 PR 显式审批
- 集成风险前置到 Sprint 0

### 2.3 任务粒度设计

```
任务规模分布:
1-2 人天  ████████████████  12 任务 (44%)
3-4 人天  ██████████        8 任务 (30%)
5-6 人天  ██████            5 任务 (19%)
7-9 人天  ████              2 任务 (7%)
```

**最佳实践**: 单任务不超过 9 人天，超过则拆分。

### 2.4 强制 Code Review

每轮代码提交必须通过质量门禁：

| 级别   | 数量  | 典型案例                        |
| :----- | :---: | :------------------------------ |
| HIGH   |   4   | i18n 硬编码、变量遮蔽、内存泄漏 |
| MEDIUM |   5   | 边界条件未覆盖、错误处理不完整  |
| LOW    |   3   | 代码风格、命名规范              |

**效果**: 6 轮 Code Review 共发现并修复 12 个缺陷，0 个生产事故。

---

## 三、执行时间线

### 3.1 关键事件耗时

| 时间      | 事件                            |  耗时 |
| :-------- | :------------------------------ | ----: |
| 10:22:47  | 文档准备、调研材料整理          |     - |
| 11:34:50  | Sprint 0 启动：接口契约 + Mock  | 72min |
| 12:54:40  | P1-C001 搜索高亮完成            | 80min |
| 12:57:20  | Sprint 0 全部完成 + Code Review |  2min |
| 13:06:34  | P1-A002 指标框架完成            |  9min |
| 13:43:55  | P2-B001 习惯学习完成            |  8min |
| 13:55:57  | P2-C001 智能标签完成            | 12min |
| 14:40:24  | P2-A003 会话持久化完成          |  4min |
| 15:17:37  | P3-B003 批量日程完成            | 17min |
| ~15:30:00 | 项目结束                        | 12min |

### 3.2 Phase 效率分析

| Phase    |       原计划 |     实际耗时 |    压缩比 |
| :------- | -----------: | -----------: | --------: |
| Sprint 0 |       9 人天 |      ~85 min |     1:152 |
| Phase 1  |      32 人天 |      ~65 min |     1:710 |
| Phase 2  |      40 人天 |      ~70 min |     1:823 |
| Phase 3  |      36 人天 |      ~75 min |     1:691 |
| **合计** | **117 人天** | **~295 min** | **1:572** |

## 四、可复用模式

### 4.1 AI 虚拟团队研发流程

```text
1. Human Architect 定义 INDEX.md (任务+依赖+验收)
2. Sprint 0: 接口契约 + Mock 实现
3. 并行执行: Team A/B/C 基于契约独立开发
4. 每 Commit: 强制 Code Review + 测试验证
5. 每 Sprint: 集成验收 + 状态同步
6. 最终交付: Human Architect 验收
```

### 4.2 接口契约模板

Sprint 0 核心产物，用于解耦并行开发：

```go
// 1. 先定义接口
type [Service]Service interface {
    [Method1](ctx, [params]) ([result], error)
    [Method2](ctx, [params]) ([result], error)
}

// 2. 提供 Mock
type Mock[Service]Service struct { ... }
```

### 4.3 Spec 文档模板

每个任务应包含 Standard Spec Structure：

- **功能描述**: 清晰的用户价值
- **技术方案**: 架构、API、数据模型
- **验收标准**: 可量化的完成条件
- **依赖关系**: 前置任务和下游任务
- **投入估算**: 人天

实现代码结构模板：

```go
// 3. 实现真实逻辑
type [service] struct { ... }
```

## 五、经验与教训

### 5.1 成功经验

| 经验             | 说明                              |
| :--------------- | :-------------------------------- |
| **人类主导决策** | AI 执行交付，人类决定 What 和 Why |
| **文档驱动**     | INDEX.md 作为单一权威源           |
| **接口先行**     | Sprint 0 解除跨团队阻塞           |
| **强制 Review**  | 每次提交必须通过质量门禁          |
| **增量交付**     | 每个 Spec 独立可部署              |

### 5.2 待改进与挑战

| 问题               | 改进建议                          |
| :----------------- | :-------------------------------- |
| **跨团队集成验收** | 部分验收点仍为 `[ ]` 状态，需强化 |
| **性能基准**       | 缺少系统性能回归测试              |

## 六、给后来者的建议

### 6.1 适用场景评估

| 场景             | 适用度 | 说明           |
| :--------------- | -----: | :------------- |
| 产品迭代规划执行 |  ★★★★★ | 本项目验证     |
| 多模块并行开发   |  ★★★★★ | 依赖管理有效   |
| 原型快速验证     |  ★★★★☆ | 需人类提供设计 |
| 探索性研发       |  ★★☆☆☆ | AI 不擅长战略  |

### 6.2 实施建议

1. **项目启动前**
   - **准备高质量输入材料**：明确市场定位、调研结论和里程碑规划。
   - **定义清晰的验收标准**：制定可量化的检查清单和 Code Review 规范。

2. **执行过程中**
   - **保持 INDEX.md 为单一信息源**：所有状态变更实时写入 INDEX.md，避免信息孤岛。
   - **强制质量门禁**：每 Commit 必须 Code Review，测试覆盖率作为硬性要求；发现问题当场修复，不累积。
   - **及时处理阻塞**：发现依赖阻塞立即通知 PM，不要等待下一个 Sprint。

3. **项目结束后**
   - **复盘与归档**：保持文档与代码同步，记录成功模式与教训。

## 七、附录：关键文档索引

| 类别         | 文档         | 路径                                      |
| :----------- | :----------- | :---------------------------------------- |
| **产品调研** | 日程管理调研 | `docs/research/schedule-research.md`      |
| **产品调研** | 笔记增强调研 | `docs/research/memo-research.md`          |
| **产品调研** | 智能助理调研 | `docs/research/assistant-research.md`     |
| **路线图**   | 主路线图     | `docs/research/00-master-roadmap.md`      |
| **路线图**   | 实施计划     | `docs/specs/INDEX.md`                     |
| **完成报告** | 项目总结     | `docs/specs/PROJECT_COMPLETION_REPORT.md` |
| **完成报告** | Team A 报告  | `docs/specs/TEAM_A_METHODOLOGY_REPORT.md` |
| **完成报告** | Team B 报告  | `docs/specs/TEAM_B_METHODOLOGY_REPORT.md` |

---

## 八、附录：详细实施规格

以下是本次迭代执行的完整规格清单（数据来源：`docs/specs/INDEX.md`）：

### 9.1 Phase 1 (基础稳定)

| Sprint | Spec ID     | 功能模块            | 团队  | 预估工作量 | 状态  |
| :----: | :---------- | :------------------ | :---: | ---------: | :---: |
|   0    | S0-contract | 公共接口定义 + Mock |   A   |      5人天 |   ✅   |
|   1    | P1-A001     | 轻量记忆系统        |   A   |      3人天 |   ✅   |
|   1    | P1-A002     | 基础评估指标        |   A   |      2人天 |   ✅   |
|   1    | P1-B001     | 工具可靠性增强      |   B   |      2人天 |   ✅   |
|   1    | P1-B002     | 错误恢复机制        |   B   |      1人天 |   ✅   |
|   1    | P1-C001     | 搜索结果高亮        |   C   |      3人天 |   ✅   |
|   1    | P1-C002     | 上下文智能摘录      |   C   |      2人天 |   ✅   |
|   2    | P1-A003     | LLM路由优化         |   A   |      3人天 |   ✅   |
|   2    | P1-A004     | 时间解析服务        |   A   |      2人天 |   ✅   |
|   2    | P1-A005     | 通用缓存层          |   A   |      1人天 |   ✅   |
|   2    | P1-B003     | 时间解析加固        |   B   |      2人天 |   ✅   |
|   2    | P1-B004     | 规则分类器扩展      |   B   |      2人天 |   ✅   |
|   2    | P1-C003     | 相关笔记推荐        |   C   |      6人天 |   ✅   |

### 9.2 Phase 2 (智能进化)

| Sprint | Spec ID | 功能模块           | 团队  | 预估工作量 | 状态  |
| :----: | :------ | :----------------- | :---: | ---------: | :---: |
|   3    | P2-A001 | Self-RAG 检索优化  |   A   |      3人天 |   ✅   |
|   3    | P2-A002 | 上下文增强构建器   |   A   |      3人天 |   ✅   |
|   3    | P2-B001 | 用户习惯学习系统   |   B   |      5人天 |   ✅   |
|   3    | P2-B002 | 快速创建模式       |   B   |      4人天 |   ✅   |
|   3    | P2-C001 | 智能标签建议       |   C   |      7人天 |   ✅   |
|   4    | P2-A003 | 会话持久化服务     |   A   |      3人天 |   ✅   |
|   4    | P2-B003 | 后端预检 API       |   B   |      2人天 |   ✅   |
|   4    | P2-B004 | Generative UI 增强 |   B   |      4人天 |   ✅   |
|   4    | P2-C002 | 重复检测系统       |   C   |      9人天 |   ✅   |

### 9.3 Phase 3 (极致体验)

| Sprint | Spec ID | 功能模块            | 团队  | 预估工作量 | 状态  |
| :----: | :------ | :------------------ | :---: | ---------: | :---: |
|   5    | P3-A001 | 本地模型集成        |   A   |      5人天 |   ⏸️   |
|   5    | P3-B001 | 预测性交互系统      |   B   |      5人天 |   ✅   |
|   5    | P3-B002 | 主动提醒系统        |   B   |      4人天 |   ✅   |
|   5    | P3-C001 | 知识图谱可视化 (I)  |   C   |      8人天 |   ✅   |
|   6    | P3-A002 | 模型路由器          |   A   |      3人天 |   ⏸️   |
|   6    | P3-B003 | 批量日程支持        |   B   |      6人天 |   ✅   |
|   6    | P3-C001 | 知识图谱可视化 (II) |   C   |      5人天 |   ✅   |
|   6    | P3-C002 | 智能回顾系统        |   C   |      8人天 |   ✅   |

---

> **报告生成时间**: 2026-01-27
> **作者**: 人类产品负责人 + AI PM 协作
> **版本**: v1.0
