# =============================================================================
# Memos 生产环境配置 (单机 2C2G 部署)
# =============================================================================
#
# 使用方式:
#   1. 复制此文件: cp .env.prod.example .env.prod
#   2. 修改 POSTGRES_PASSWORD 为强密码
#   3. 配置 AI API Keys
#   4. 不要将 .env.prod 提交到 Git
#
# =============================================================================

# =============================================================================
# 镜像配置 (国内用户推荐)
# =============================================================================
# 使用预构建镜像，跳过本地构建 (无需安装 Go/Node.js)
# 官方镜像: ghcr.io/usememos/memos:latest
# 自定义镜像: ghcr.io/hry/memos:latest
# Docker Hub (可能需要加速): neosmemo/memos:latest
USER_IMAGE=ghcr.io/hry/memos:latest

# 自定义 PostgreSQL 镜像 (默认使用 pgvector/pgvector:pg16)
# 如果 Docker Hub 访问慢，可使用阿里云镜像
# POSTGRES_IMAGE=pgvector/pgvector:pg16

# =============================================================================
# 基础配置
# =============================================================================
# 服务端口
MEMOS_PORT=5230

# 时区
TZ=Asia/Shanghai

# =============================================================================
# PostgreSQL 数据库配置 (Docker 容器)
# =============================================================================
# 数据库名称
POSTGRES_DB=memos

# 数据库用户
POSTGRES_USER=memos

# 数据库密码 (务必修改！)
POSTGRES_PASSWORD=your_secure_password

# PostgreSQL 外部访问端口 (可选)
# 取消注释后，可通过 127.0.0.1:25432 直连数据库
# 警告: 仅在需要外部管理工具连接时开启
# POSTGRES_PORT_MAPPING=127.0.0.1:25432:5432

# =============================================================================
# 实例 URL
# =============================================================================
#
# 填写公网访问地址，用于生成 API 回调链接
# 示例: https://memos.yourdomain.com 或 http://your-server-ip:5230
#
MEMOS_INSTANCE_URL=http://your-server-ip:5230

# =============================================================================
# AI 功能配置
# =============================================================================
# 启用 AI 功能
MEMOS_AI_ENABLED=true

# --- Embedding 配置 (SiliconFlow) ---
MEMOS_AI_EMBEDDING_PROVIDER=siliconflow
MEMOS_AI_EMBEDDING_MODEL=BAAI/bge-m3
# SiliconFlow API Key
MEMOS_AI_SILICONFLOW_API_KEY=sk-your-siliconflow-api-key

# --- LLM 配置 (DeepSeek) ---
MEMOS_AI_LLM_PROVIDER=deepseek
MEMOS_AI_LLM_MODEL=deepseek-chat
# DeepSeek API Key
MEMOS_AI_DEEPSEEK_API_KEY=sk-your-deepseek-api-key

# --- Reranker 配置 ---
# 使用 SiliconFlow 作为 Reranker 提供商
MEMOS_AI_RERANK_MODEL=BAAI/bge-reranker-v2-m3

# --- OpenAI (可选) ---
# 如果使用 OpenAI 或兼容 API，取消注释并配置
# MEMOS_AI_OPENAI_API_KEY=sk-your-openai-api-key

# =============================================================================
# 数据持久化
# =============================================================================
#
# 数据存储位置:
#   - PostgreSQL 数据: Docker volume 'postgres_data'
#   - Memos 附件: Docker volume 'memos_data'
#
# 备份建议:
#   1. 定期备份数据库: ./deploy.sh backup
#   2. 或使用 cron 定时备份
#
# 查看卷: docker volume ls
# 备份卷: docker run --rm -v postgres_data:/data -v $(pwd):/backup alpine tar czf /backup/postgres-backup.tar.gz /data
#
# =============================================================================
