# å¿«é€Ÿå¼€å§‹

<cite>
**æœ¬æ–‡å¼•ç”¨çš„æ–‡ä»¶**
- [README.md](file://README.md)
- [Makefile](file://Makefile)
- [docker/compose/dev.yml](file://docker/compose/dev.yml)
- [docker/compose/prod.yml](file://docker/compose/prod.yml)
- [.env.example](file://.env.example)
- [.env.prod.example](file://deploy/aliyun/.env.prod.example)
- [go.mod](file://go.mod)
- [deploy/aliyun/deploy.sh](file://deploy/aliyun/deploy.sh)
</cite>

## æ›´æ–°æ‘˜è¦
**æ‰€åšæ›´æ”¹**
- æ›´æ–°äº†AIåŠŸèƒ½è®¾ç½®çš„è¯¦ç»†è¯´æ˜ï¼ŒåŒ…æ‹¬ç¯å¢ƒå˜é‡é…ç½®
- å¢åŠ äº†PostgreSQL 16+å’Œpgvectoræ‰©å±•çš„æ˜ç¡®è¦æ±‚
- å®Œå–„äº†Docker Composeéƒ¨ç½²æ­¥éª¤å’Œé…ç½®é€‰é¡¹
- æ·»åŠ äº†å¤šç§AIæ¨¡å‹æä¾›å•†çš„é…ç½®æ–¹æ¡ˆ
- ä¼˜åŒ–äº†å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒçš„éƒ¨ç½²æµç¨‹

## ç›®å½•
1. [ç®€ä»‹](#ç®€ä»‹)
2. [æ ¸å¿ƒä»·å€¼ä¸»å¼ ](#æ ¸å¿ƒä»·å€¼ä¸»å¼ )
3. [å¿«é€Ÿä½“éªŒ](#å¿«é€Ÿä½“éªŒ)
4. [æœ¬åœ°å¼€å‘ç¯å¢ƒ](#æœ¬åœ°å¼€å‘ç¯å¢ƒ)
5. [ç”Ÿäº§éƒ¨ç½²](#ç”Ÿäº§éƒ¨ç½²)
6. [æ ¸å¿ƒåŠŸèƒ½æ¦‚è§ˆ](#æ ¸å¿ƒåŠŸèƒ½æ¦‚è§ˆ)
7. [å¸¸è§é—®é¢˜è§£ç­”](#å¸¸è§é—®é¢˜è§£ç­”)
8. [å¼€å‘æŒ‡å—](#å¼€å‘æŒ‡å—)

## ç®€ä»‹

Memos æ˜¯ä¸€æ¬¾**éšç§ä¼˜å…ˆçš„ AI ç¬”è®°åŠ©æ‰‹**ï¼Œä¸“ä¸ºç°ä»£å·¥ä½œæµè®¾è®¡ã€‚å®ƒå°†è½»é‡çº§ç¬”è®°ã€æ™ºèƒ½æ—¥ç¨‹ç®¡ç†å’Œå¤šæ™ºèƒ½ä½“ AI åŠŸèƒ½å®Œç¾èåˆï¼Œè®©çŸ¥è¯†ç®¡ç†å˜å¾—ç®€å•è€Œå¼ºå¤§ã€‚

**ä¸ºä»€ä¹ˆé€‰æ‹© Memosï¼Ÿ**
- ğŸ”’ **éšç§ä¼˜å…ˆ**ï¼šè‡ªæ‰˜ç®¡éƒ¨ç½²ï¼Œæ•°æ®å®Œå…¨ç”±ä½ æŒæ§
- ğŸ“ **è½»é‡ç¬”è®°**ï¼šæ‰“å¼€å³å†™ï¼Œæ”¯æŒ Markdown æ ¼å¼
- ğŸ¤– **AI å¢å¼º**ï¼šä¸‰ä¸ªä¸“ä¸šæ™ºèƒ½ä½“ååŒå·¥ä½œ
- ğŸ“… **æ™ºèƒ½æ—¥ç¨‹**ï¼šè‡ªç„¶è¯­è¨€è¾“å…¥ï¼Œå†²çªæ£€æµ‹ä¿æŠ¤

## æ ¸å¿ƒä»·å€¼ä¸»å¼ 

### éšç§ä¼˜å…ˆ
- å®Œå…¨è‡ªæ‰˜ç®¡ï¼Œæ— é¥æµ‹æ•°æ®ä¼ è¾“
- æ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨ä½ çš„æœåŠ¡å™¨ä¸Š
- æ”¯æŒå¤šç§éƒ¨ç½²æ–¹å¼ï¼šDockerã€ä¼ ç»Ÿéƒ¨ç½²

### AI å¢å¼ºä½“éªŒ
Memos å†…ç½®ä¸‰ä¸ªä¸“ä¸šæ™ºèƒ½ä½“ï¼Œæ¯ä¸ªéƒ½æœ‰ç‹¬ç‰¹ä¸“é•¿ï¼š

| æ™ºèƒ½ä½“ | ä¸“é•¿ | ç¤ºä¾‹ |
|:---:|:---|:---|
| ğŸ¦œ **ç°ç°** | ç¬”è®°æœç´¢ | "æˆ‘ä¹‹å‰å†™è¿‡å…³äº React çš„ç¬”è®°å—ï¼Ÿ" |
| ğŸ“… **é‡‘åˆš** | æ—¥ç¨‹ç®¡ç† | "å¸®æˆ‘å®‰æ’æ˜å¤©ä¸‹åˆçš„ä¼šè®®" |
| â­ **æƒŠå¥‡** | ç»¼åˆåŠ©æ‰‹ | "æ€»ç»“ä¸€ä¸‹æœ¬å‘¨çš„å·¥ä½œå’Œæ—¥ç¨‹" |

### æ™ºèƒ½æ—¥ç¨‹ç®¡ç†
- è‡ªç„¶è¯­è¨€è¾“å…¥ï¼š"æ˜å¤©ä¸‹åˆ3ç‚¹å¼€ä¼š" ç›´æ¥åˆ›å»º
- è‡ªåŠ¨å†²çªæ£€æµ‹å’Œæé†’
- æ”¯æŒé‡å¤è§„åˆ™å’Œæ‹–æ‹½è°ƒæ•´
- å¤šè§†å›¾åˆ‡æ¢ï¼šæœˆ/å‘¨/æ—¥è§†å›¾

## å¿«é€Ÿä½“éªŒ

### Docker ä¸€é”®å¯åŠ¨ï¼ˆåŸºç¡€åŠŸèƒ½ï¼‰
```bash
docker run -d --name memos -p 5230:5230 -v ~/.memos:/var/opt/memos hrygo/memos:stable
```

### å¯ç”¨ AI åŠŸèƒ½ï¼ˆPostgreSQL + API Keyï¼‰
```bash
# 1. å…‹éš†ä»“åº“
git clone https://github.com/hrygo/memos.git && cd memos

# 2. é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
# ç¼–è¾‘ .env å¡«å…¥ API Keyï¼ˆè§æ–‡ä»¶å†…è¯¦ç»†è¯´æ˜ï¼‰

# 3. å®‰è£…ä¾èµ–
make deps-all

# 4. å¯åŠ¨ (PostgreSQL + åç«¯ + å‰ç«¯)
make start
```

**è®¿é—®åœ°å€**ï¼šhttp://localhost:25173

### ä¸€é”®å¯åŠ¨ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
```bash
# 1. å…‹éš†ä»“åº“
git clone https://github.com/hrygo/memos.git && cd memos

# 2. é…ç½®ç¯å¢ƒå˜é‡
cp .env.prod.example .env.prod
# ç¼–è¾‘ .env.prod å¡«å…¥ï¼š
#   POSTGRES_PASSWORD=your_secure_password
#   MEMOS_AI_SILICONFLOW_API_KEY=sk-xxx
#   MEMOS_AI_DEEPSEEK_API_KEY=sk-xxx

# 3. å¯åŠ¨ (PostgreSQL + Memos)
docker compose -f docker/compose/prod.yml --env-file .env.prod up -d
```

## æœ¬åœ°å¼€å‘ç¯å¢ƒ

### ç³»ç»Ÿè¦æ±‚
- **åç«¯**ï¼šGo 1.25+
- **å‰ç«¯**ï¼šNode.js 22+ ä¸ pnpm
- **å®¹å™¨**ï¼šDockerï¼ˆç”¨äº PostgreSQL å®¹å™¨ï¼‰
- **æ•°æ®åº“**ï¼šPostgreSQL 16+ï¼ˆå¿…é¡»ä½¿ç”¨ `pgvector/pgvector:pg16` é•œåƒï¼‰

### å¼€å‘ç¯å¢ƒé…ç½®
- **æ•°æ®åº“**ï¼šPostgreSQL 16 + pgvector æ‰©å±•
- **AI åŠŸèƒ½**ï¼šé»˜è®¤å¯ç”¨ï¼Œæ”¯æŒ SiliconFlow å’Œ DeepSeek
- **å‰ç«¯ä»£ç†**ï¼šè‡ªåŠ¨è½¬å‘ /apiã€/memos.api.v1ã€/file è¯·æ±‚è‡³åç«¯
- **çƒ­é‡è½½**ï¼šå‰ç«¯å¼€å‘æœåŠ¡å™¨æ”¯æŒå®æ—¶æ›´æ–°

### ä¸€é”®å¯åŠ¨æµç¨‹
1. **å¯åŠ¨ PostgreSQL**ï¼š`make docker-up`
2. **å¯åŠ¨åç«¯**ï¼š`make start`
3. **å¯åŠ¨å‰ç«¯**ï¼šè‡ªåŠ¨å¯åŠ¨ï¼Œç›‘å¬ 25173 ç«¯å£

```mermaid
sequenceDiagram
participant Dev as "å¼€å‘è€…"
participant Make as "Makefile"
participant Script as "scripts/dev.sh"
participant PG as "PostgreSQL(pgvector)"
participant BE as "åç«¯(Go/Echo)"
participant FE as "å‰ç«¯(React/Vite)"
Dev->>Make : make docker-up
Make->>PG : å¯åŠ¨å®¹å™¨å¹¶æŒ‚è½½åˆå§‹åŒ–è„šæœ¬
Dev->>Make : make start
Make->>Script : è°ƒç”¨å¯åŠ¨è„šæœ¬
Script->>PG : ç­‰å¾…ç«¯å£ 25432 å°±ç»ª
Script->>BE : å¯åŠ¨åç«¯(ç«¯å£ 28081)
Script->>FE : å¯åŠ¨å‰ç«¯(ç«¯å£ 25173)
FE-->>Dev : http : //localhost : 25173
BE-->>Dev : http : //localhost : 28081
```

## ç”Ÿäº§éƒ¨ç½²

### Docker Compose éƒ¨ç½²
```bash
# 1. å‡†å¤‡é…ç½®æ–‡ä»¶
cp .env.prod.example .env.prod

# 2. ç¼–è¾‘ .env.prodï¼Œå¡«å…¥å¿…è¦çš„é…ç½®é¡¹
# - POSTGRES_PASSWORDï¼šæ•°æ®åº“å¯†ç 
# - MEMOS_AI_SILICONFLOW_API_KEYï¼šSiliconFlow API Key
# - MEMOS_AI_DEEPSEEK_API_KEYï¼šDeepSeek API Key

# 3. å¯åŠ¨æœåŠ¡
docker compose -f docker/compose/prod.yml --env-file .env.prod up -d
```

### ç¯å¢ƒå˜é‡é…ç½®
```bash
# æ•°æ®åº“é…ç½®
MEMOS_DRIVER=postgres
MEMOS_DSN=postgres://memos:memos@postgres:5432/memos?sslmode=disable

# AI åŠŸèƒ½é…ç½®
MEMOS_AI_ENABLED=true
MEMOS_AI_EMBEDDING_PROVIDER=siliconflow
MEMOS_AI_LLM_PROVIDER=deepseek
MEMOS_AI_SILICONFLOW_API_KEY=sk-your-siliconflow-key
MEMOS_AI_DEEPSEEK_API_KEY=sk-your-deepseek-key
```

### ç«¯å£æ˜ å°„
- **Memos åº”ç”¨**ï¼š5230ï¼ˆå¯é…ç½®ï¼‰
- **PostgreSQL**ï¼š5432ï¼ˆå¯é€‰æ˜ å°„åˆ°å®¿ä¸»æœºï¼‰

### PostgreSQL è¦æ±‚
- **å¿…é¡»ä½¿ç”¨**ï¼š`pgvector/pgvector:pg16` é•œåƒ
- **ç‰ˆæœ¬è¦æ±‚**ï¼šPostgreSQL 16+
- **æ‰©å±•è¦æ±‚**ï¼špgvector æ‰©å±•å·²é¢„åŠ è½½
- **å†…å­˜ä¼˜åŒ–**ï¼šé’ˆå¯¹ 2GB RAM æœåŠ¡å™¨ä¼˜åŒ–é…ç½®

## æ ¸å¿ƒåŠŸèƒ½æ¦‚è§ˆ

### ç¬”è®°ç®¡ç†
- **å¿«é€Ÿè®°å½•**ï¼šæ‰“å¼€å³å†™ï¼Œæ”¯æŒ Markdown
- **æ ‡ç­¾åˆ†ç±»**ï¼š`#æ ‡ç­¾` è‡ªåŠ¨å½’ç±»
- **æ—¶é—´çº¿**ï¼šæŒ‰æ—¶é—´æµæµè§ˆç¬”è®°
- **é™„ä»¶ä¸Šä¼ **ï¼šå›¾ç‰‡ã€æ–‡ä»¶åµŒå…¥
- **æœç´¢è¿‡æ»¤**ï¼šå…³é”®è¯ã€æ ‡ç­¾ã€æ—¶é—´èŒƒå›´

### æ—¥ç¨‹ç®¡ç†
- **æ—¥å†è§†å›¾**ï¼šæœˆ/å‘¨/æ—¥å¤šè§†å›¾åˆ‡æ¢
- **è‡ªç„¶è¯­è¨€**ï¼šç›´æ¥åˆ›å»ºä¼šè®®å’Œæ´»åŠ¨
- **å†²çªæ£€æµ‹**ï¼šè‡ªåŠ¨æé†’æ—¶é—´å†²çª
- **æ‹–æ‹½è°ƒæ•´**ï¼šæ—¥å†ä¸Šç›´æ¥æ‹–åŠ¨
- **é‡å¤è§„åˆ™**ï¼šæ¯å¤©/å‘¨/æœˆè‡ªåŠ¨é‡å¤

### AI æ™ºèƒ½ä½“
ä¸‰ä¸ªä¸“ä¸šåŒ–çš„"é¹¦é¹‰æ™ºèƒ½ä½“"åä½œå¤„ç†ä¸åŒä»»åŠ¡ï¼š

#### ç°ç°ï¼ˆç¬”è®°æœç´¢ï¼‰
- è¯­ä¹‰æœç´¢ç¬”è®°å†…å®¹
- æ™ºèƒ½é—®ç­”å’Œæ€»ç»“
- æ ‡ç­¾å…³è”å’Œåˆ†ç±»

#### é‡‘åˆšï¼ˆæ—¥ç¨‹ç®¡ç†ï¼‰
- è‡ªç„¶è¯­è¨€åˆ›å»ºæ—¥ç¨‹
- å†²çªæ£€æµ‹å’Œæé†’
- é‡å¤è§„åˆ™ç®¡ç†

#### æƒŠå¥‡ï¼ˆç»¼åˆåŠ©æ‰‹ï¼‰
- å¤šç»´åº¦ä¿¡æ¯æ•´åˆ
- å·¥ä½œæ€»ç»“å’Œåˆ†æ
- è·¨é¢†åŸŸçŸ¥è¯†å…³è”

## å¸¸è§é—®é¢˜è§£ç­”

### å¦‚ä½•è·å– API Keyï¼Ÿ
- **SiliconFlow**ï¼šæ³¨å†Œè´¦å·ååœ¨æ§åˆ¶å°è·å–
- **DeepSeek**ï¼šæ³¨å†Œååœ¨ API é¡µé¢åˆ›å»ºå¯†é’¥
- **OpenAI**ï¼šéœ€è¦æµ·å¤–ç½‘ç»œç¯å¢ƒ

### ç«¯å£å†²çªå¦‚ä½•è§£å†³ï¼Ÿ
- åç«¯ç«¯å£ï¼š28081
- å‰ç«¯ç«¯å£ï¼š25173  
- æ•°æ®åº“ç«¯å£ï¼š25432ï¼ˆå¼€å‘ï¼‰/ 5432ï¼ˆç”Ÿäº§ï¼‰

### å¦‚ä½•åˆ‡æ¢åˆ° SQLiteï¼Ÿ
```bash
# ä¿®æ”¹ .env æ–‡ä»¶
MEMOS_DRIVER=sqlite
MEMOS_DSN=/var/opt/memos/memos.db
```

**æ³¨æ„**ï¼šSQLite ä¸æ”¯æŒ AI åŠŸèƒ½

### å¦‚ä½•å¤‡ä»½æ•°æ®ï¼Ÿ
```bash
# å¤‡ä»½ PostgreSQL æ•°æ®
docker exec memos-postgres pg_dump -U memos memos > backup.sql

# å¤‡ä»½æ–‡ä»¶å­˜å‚¨
tar -czf memos-data.tar.gz ~/.memos
```

### AI æ¨¡å‹é…ç½®æ–¹æ¡ˆ

#### æ–¹æ¡ˆ A: SiliconFlow + DeepSeek [æ¨è]
```bash
MEMOS_AI_SILICONFLOW_API_KEY=sk-xxx
MEMOS_AI_DEEPSEEK_API_KEY=sk-xxx
```

#### æ–¹æ¡ˆ B: çº¯ SiliconFlow
```bash
MEMOS_AI_LLM_PROVIDER=siliconflow
MEMOS_AI_SILICONFLOW_API_KEY=sk-xxx
MEMOS_AI_LLM_MODEL=Qwen/Qwen2.5-72B-Instruct
```

#### æ–¹æ¡ˆ C: OpenAI å…¨å®¶æ¡¶
```bash
MEMOS_AI_EMBEDDING_PROVIDER=openai
MEMOS_AI_LLM_PROVIDER=openai
MEMOS_AI_OPENAI_API_KEY=sk-xxx
MEMOS_AI_EMBEDDING_MODEL=text-embedding-3-small
MEMOS_AI_LLM_MODEL=gpt-4o
```

#### æ–¹æ¡ˆ D: æœ¬åœ° Ollama
```bash
MEMOS_AI_EMBEDDING_PROVIDER=ollama
MEMOS_AI_LLM_PROVIDER=ollama
MEMOS_AI_OLLAMA_BASE_URL=http://localhost:11434
MEMOS_AI_EMBEDDING_MODEL=nomic-embed-text
MEMOS_AI_LLM_MODEL=llama3.1
```

## å¼€å‘æŒ‡å—

### å¼€å‘å‘½ä»¤
```bash
# å¯åŠ¨æ‰€æœ‰æœåŠ¡
make start

# åœæ­¢æ‰€æœ‰æœåŠ¡
make stop

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
make status

# æŸ¥çœ‹æ—¥å¿—
make logs

# è¿è¡Œæµ‹è¯•
make test
```

### ç¯å¢ƒå˜é‡å‚è€ƒ
```bash
# å¿…å¡«é…ç½®
MEMOS_DRIVER=postgres
MEMOS_DSN=postgres://memos:memos@localhost:25432/memos?sslmode=disable

# AI åŠŸèƒ½
MEMOS_AI_ENABLED=true
MEMOS_AI_SILICONFLOW_API_KEY=sk-your-key
MEMOS_AI_DEEPSEEK_API_KEY=sk-your-key

# æ¨¡å‹é…ç½®
MEMOS_AI_EMBEDDING_PROVIDER=siliconflow
MEMOS_AI_LLM_PROVIDER=deepseek
MEMOS_AI_EMBEDDING_MODEL=BAAI/bge-m3
MEMOS_AI_LLM_MODEL=deepseek-chat
```

### æ„å»ºå’Œéƒ¨ç½²
```bash
# å®‰è£…ä¾èµ–
make deps-all

# æ„å»ºå‰ç«¯
make build-web

# æ„å»ºåç«¯
make build

# ä¸€é”®å¯åŠ¨
make start
```

### æ•…éšœæ’é™¤
- **Docker æœªè¿è¡Œ**ï¼šå…ˆå®‰è£…å¹¶å¯åŠ¨ Docker
- **ç«¯å£è¢«å ç”¨**ï¼šæ£€æŸ¥ 28081ã€25173ã€25432 ç«¯å£
- **æ•°æ®åº“è¿æ¥å¤±è´¥**ï¼šç¡®è®¤ PostgreSQL å·²å¯åŠ¨ä¸”ç«¯å£å¯è¾¾
- **AI åŠŸèƒ½å¼‚å¸¸**ï¼šæ£€æŸ¥ API Key é…ç½®å’Œç½‘ç»œè¿æ¥
- **pgvector æ‰©å±•ç¼ºå¤±**ï¼šç¡®è®¤ä½¿ç”¨æ­£ç¡®çš„ `pgvector/pgvector:pg16` é•œåƒ