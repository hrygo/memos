# æ—¥ç¨‹ç®¡ç† AI Native é‡æ„æ–¹æ¡ˆ

## ä¸€ã€ç°çŠ¶åˆ†æ

### 1.1 å‰ç«¯æ¶æ„ç°çŠ¶

| ç»„ä»¶ | è·¯å¾„ | åŠŸèƒ½ |
|------|------|------|
| `ScheduleQuickInput` | `web/src/components/ScheduleQuickInput/` | è‡ªç„¶è¯­è¨€è¾“å…¥ï¼ŒAI è§£æ |
| `ScheduleTimeline` | `web/src/components/AIChat/ScheduleTimeline.tsx` | æ—¥è§†å›¾æ—¶é—´è½´ |
| `ScheduleCalendar` | `web/src/components/AIChat/ScheduleCalendar.tsx` | æœˆè§†å›¾æ—¥å† |
| `GenerativeUIContainer` | `web/src/components/ScheduleAI/` | AI ç”Ÿæˆå¼ UI å®¹å™¨ |
| `ConflictResolution` | `web/src/components/ScheduleAI/ConflictResolution.tsx` | å†²çªè§£å†³ UI |

**ç°æœ‰ä¼˜ç‚¹**:
- è‡ªç„¶è¯­è¨€è¾“å…¥ + AI è§£æå·²å®ç°
- åŒè§†å›¾æ¨¡å¼ï¼ˆTimeline/Calendarï¼‰
- å†²çªæ£€æµ‹å’Œå»ºè®®æ—¶é—´æ§½
- Generative UI æ¡†æ¶å·²æ­å»º

**å­˜åœ¨é—®é¢˜**:
1. **äº¤äº’æ–­å±‚**: ç”¨æˆ·è¾“å…¥åéœ€ç­‰å¾… AI è¿”å›æ–‡æœ¬ï¼Œå†æ‰‹åŠ¨ç¡®è®¤ï¼Œæµç¨‹å‰²è£‚
2. **åé¦ˆä¸è¶³**: ç¼ºå°‘å®æ—¶æµå¼åé¦ˆï¼Œç”¨æˆ·ä¸çŸ¥é“ AI åœ¨"æ€è€ƒ"ä»€ä¹ˆ
3. **å»ºè®®å•ä¸€**: åªæä¾›æ—¶é—´å»ºè®®ï¼Œç¼ºå°‘æ™ºèƒ½æ¨èï¼ˆå¦‚åŸºäºå†å²ä¹ æƒ¯ï¼‰
4. **ç¼–è¾‘ä½“éªŒå·®**: ä¿®æ”¹æ—¥ç¨‹éœ€è¦é‡æ–°æè¿°ï¼Œç¼ºå°‘ç›´æ¥æ‹–æ‹½è°ƒæ•´

### 1.2 åç«¯ Agent æ¶æ„ç°çŠ¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ScheduleParrotV2                       â”‚
â”‚  (plugin/ai/agent/schedule_parrot_v2.go)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ SchedulerAgentV2â”‚â”€â”€â”€â–¶â”‚ Agent (ReAct Loop)          â”‚ â”‚
â”‚  â”‚ scheduler_v2.go â”‚    â”‚ Max 10 iterations           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Tools (plugin/ai/agent/tools/scheduler.go):            â”‚
â”‚  â€¢ schedule_query  - æŸ¥è¯¢æ—¥ç¨‹                           â”‚
â”‚  â€¢ schedule_add    - åˆ›å»ºæ—¥ç¨‹ (å¸¦è‡ªåŠ¨å†²çªè§£å†³)           â”‚
â”‚  â€¢ schedule_update - æ›´æ–°æ—¥ç¨‹                           â”‚
â”‚  â€¢ find_free_time  - æŸ¥æ‰¾ç©ºé—²æ—¶é—´                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Schedule Service (server/service/schedule/)             â”‚
â”‚  â€¢ å†²çªæ£€æµ‹ (CheckConflicts)                            â”‚
â”‚  â€¢ è‡ªåŠ¨å†²çªè§£å†³ (ConflictResolver)                       â”‚
â”‚  â€¢ RRule é‡å¤æ—¥ç¨‹å±•å¼€                                    â”‚
â”‚  â€¢ PostgreSQL EXCLUDE çº¦æŸä¿è¯åŸå­æ€§                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç°æœ‰ä¼˜ç‚¹**:
- Native Tool Calling (æ—  LangChain ä¾èµ–)
- è‡ªåŠ¨å†²çªæ£€æµ‹å’Œæ—¶é—´è°ƒæ•´
- DB å±‚åŸå­æ€§çº¦æŸ

**å­˜åœ¨é—®é¢˜**:
1. **æ— è§„åˆ’èƒ½åŠ›**: ç®€å• ReAct å¾ªç¯ï¼Œæ— æ³•å¤„ç†å¤æ‚å¤šæ­¥ä»»åŠ¡
2. **æ— è®°å¿†ç³»ç»Ÿ**: ä¸å­¦ä¹ ç”¨æˆ·ä¹ æƒ¯ï¼ˆå¦‚å¸¸ç”¨ä¼šè®®æ—¶é•¿ã€åå¥½æ—¶æ®µï¼‰
3. **å·¥å…·é“¾å›ºå®š**: ç¼ºå°‘åŠ¨æ€å·¥å…·ç»„åˆèƒ½åŠ›
4. **æ¨ç†ä¸é€æ˜**: ç”¨æˆ·çœ‹ä¸åˆ° Agent çš„å†³ç­–è¿‡ç¨‹

---

## äºŒã€çœŸå®ç”¨æˆ·æ—¥ç¨‹ç®¡ç†éœ€æ±‚åˆ†æ

### 2.1 æ ¸å¿ƒåœºæ™¯

| åœºæ™¯ | ç”¨æˆ·è¾“å…¥ç¤ºä¾‹ | æœŸæœ›è¡Œä¸º |
|------|-------------|---------|
| **å¿«é€Ÿåˆ›å»º** | "æ˜å¤©ä¸‹åˆ3ç‚¹å¼€ä¼š" | ç§’çº§åˆ›å»ºï¼Œæ— éœ€ç¡®è®¤ |
| **æ™ºèƒ½è¡¥å…¨** | "è·‘æ­¥" | æ ¹æ®å†å²ä¹ æƒ¯è‡ªåŠ¨å¡«å……æ—¶é—´ã€æ—¶é•¿ |
| **å†²çªå¤„ç†** | "åå¤©2ç‚¹è§å®¢æˆ·" | æ£€æµ‹å†²çªï¼Œæä¾›å¯è§†åŒ–æ›¿ä»£æ–¹æ¡ˆ |
| **æ‰¹é‡å®‰æ’** | "è¿™å‘¨æ¯å¤©æ—©ä¸Šè·‘æ­¥" | ç†è§£é‡å¤è§„åˆ™ï¼Œæ‰¹é‡åˆ›å»º |
| **æ¨¡ç³ŠæŸ¥è¯¢** | "æˆ‘è¿™å‘¨æœ‰ä»€ä¹ˆå®‰æ’" | æ™ºèƒ½èšåˆï¼Œåˆ†ç»„å±•ç¤º |
| **ä¸Šä¸‹æ–‡ä¿®æ”¹** | "æŠŠåˆšæ‰é‚£ä¸ªä¼šæ”¹åˆ°4ç‚¹" | ç†è§£æŒ‡ä»£ï¼Œç²¾å‡†ä¿®æ”¹ |

### 2.2 ç”¨æˆ·ç—›ç‚¹

1. **è¾“å…¥æˆæœ¬é«˜**: æ¯æ¬¡éƒ½è¦æè¿°å®Œæ•´ä¿¡æ¯
2. **ç¡®è®¤æ­¥éª¤å¤š**: åˆ›å»º-ç¡®è®¤-å®Œæˆï¼Œæµç¨‹ç¹ç
3. **å†²çªå¤„ç†è¢«åŠ¨**: åªåœ¨å†²çªæ—¶æé†’ï¼Œä¸ä¸»åŠ¨ä¼˜åŒ–
4. **ç¼ºå°‘æ™ºèƒ½å»ºè®®**: ä¸ä¼šæ ¹æ®æ—¥ç¨‹å¯†åº¦æ¨èä¼‘æ¯æ—¶é—´

---

## ä¸‰ã€AI Native é‡æ„æ–¹æ¡ˆ

### 3.1 å‰ç«¯ UX å‡çº§ï¼šStreaming + Generative UI

#### 3.1.1 æµå¼äº¤äº’å¢å¼º

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·è¾“å…¥: "æ˜å¤©ä¸‹åˆå¼€ä¼šè®¨è®ºäº§å“"                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [æµå¼åé¦ˆåŒº]                                           â”‚
â”‚  ğŸ” è§£æä¸­... "æ˜å¤©ä¸‹åˆ" â†’ 2026-01-27 14:00             â”‚
â”‚  ğŸ“… æ£€æŸ¥å†²çª... æ— å†²çª                                   â”‚
â”‚  âœ… åˆ›å»ºä¸­...                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [Generative UI - ç¡®è®¤å¡ç‰‡]                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ“‹ äº§å“è®¨è®ºä¼š                                      â”‚  â”‚
â”‚  â”‚ ğŸ• æ˜å¤© 14:00 - 15:00 (1å°æ—¶)                     â”‚  â”‚
â”‚  â”‚ ğŸ“ æœªè®¾ç½®åœ°ç‚¹                                      â”‚  â”‚
â”‚  â”‚                                                    â”‚  â”‚
â”‚  â”‚ [ç¡®è®¤åˆ›å»º]  [ä¿®æ”¹æ—¶é—´]  [å–æ¶ˆ]                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.1.2 æ–°å¢ç»„ä»¶

| ç»„ä»¶ | åŠŸèƒ½ |
|------|------|
| `StreamingFeedback` | å®æ—¶æ˜¾ç¤º AI æ€è€ƒè¿‡ç¨‹ |
| `SmartSuggestionBar` | åŸºäºä¸Šä¸‹æ–‡çš„æ™ºèƒ½å»ºè®®æ¡ |
| `QuickActionPill` | å¿«æ·æ“ä½œèƒ¶å›Šï¼ˆä¸€é”®é‡å¤ã€ä¸€é”®å»¶åï¼‰ |
| `DragDropTimeline` | æ”¯æŒæ‹–æ‹½è°ƒæ•´æ—¶é—´çš„æ—¶é—´è½´ |

### 3.2 åç«¯ Agent å‡çº§ï¼šæ··åˆæ¨¡å¼ï¼ˆReAct + Plan-Executeï¼‰

> **æ·±åº¦è°ƒç ”ç»“è®º**: ç»è¿‡å¯¹ç°æœ‰ä»£ç çš„åˆ†æï¼ŒSchedulerAgentV2 çš„ ReAct å®ç°å·²ç»éå¸¸æˆç†Ÿã€‚
> é¡¹ç›®ä¸­ AmazingParrot å·²æœ‰ Plan-Execute å®ç°å¯å‚è€ƒã€‚å»ºè®®é‡‡ç”¨**æ··åˆæ¨¡å¼**è€Œéå®Œå…¨æ›¿æ¢ã€‚

#### 3.2.1 ä¸ºä»€ä¹ˆä¸å®Œå…¨æ›¿æ¢ä¸º Plan-and-Execute

| å¯¹æ¯”ç»´åº¦ | ReAct (ç°æœ‰) | Plan-Execute | ç»“è®º |
|---------|-------------|--------------|------|
| **ç®€å•ä»»åŠ¡** (70%) | 1-2 æ¬¡è¿­ä»£ï¼Œè¶³å¤Ÿé«˜æ•ˆ | å›ºå®š 3 æ¬¡ LLM è°ƒç”¨ï¼Œå¼€é”€æ›´å¤§ | ReAct èƒœ |
| **å¤æ‚æ‰¹é‡** (15%) | ä¸²è¡Œæ‰§è¡Œï¼Œå»¶è¿Ÿé«˜ | å¹¶å‘æ‰§è¡Œï¼Œå»¶è¿Ÿé™ä½ 40-60% | Plan-Execute èƒœ |
| **åŠ¨æ€å†²çªè§£å†³** (10%) | å¯æ ¹æ®ç»“æœè°ƒæ•´ç­–ç•¥ | éœ€é‡æ–°è§„åˆ’ | ReAct èƒœ |
| **å¤šæ­¥æ¨ç†** (5%) | çµæ´»å†³ç­– | æ­¥éª¤å›ºå®š | ReAct èƒœ |

**ç»“è®º**: 85% çš„æ—¥ç¨‹ä»»åŠ¡é€‚åˆ ReActï¼Œ15% æ‰¹é‡/å¹¶å‘æŸ¥è¯¢åœºæ™¯é€‚åˆ Plan-Executeã€‚

#### 3.2.2 æ··åˆæ¶æ„è®¾è®¡

```
ç”¨æˆ·è¾“å…¥ â†’ IntentClassifier (æ„å›¾åˆ†ç±»)
              â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â†“                   â†“
ReAct æ¨¡å¼          Plan-Execute æ¨¡å¼
(å¤æ‚æ¨ç†)          (æ‰¹é‡/å¹¶å‘æŸ¥è¯¢)
    â”‚                   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
       ç»Ÿä¸€å“åº”æ ¼å¼
```

**æ„å›¾è·¯ç”±è§„åˆ™**:
```go
// ç®€å•åˆ›å»º/ä¿®æ”¹/å†²çªè§£å†³ â†’ ReAct
// æ‰¹é‡å®‰æ’ ("æ¯å¤©"/"æ¯å‘¨"/"ä¸‹å‘¨æ‰€æœ‰") â†’ Plan-Execute
// å¤šç±»å‹æŸ¥è¯¢ ("ç¬”è®°+æ—¥ç¨‹") â†’ Plan-Execute (å‚è€ƒ AmazingParrot)
```

#### 3.2.3 æ¸è¿›å¼ä¼˜åŒ–è·¯çº¿

**Phase 3.1**: ä¼˜åŒ–ç°æœ‰ ReAct (ä½æˆæœ¬é«˜æ”¶ç›Š)
- ä¼˜åŒ–ç³»ç»Ÿæç¤ºï¼Œæ·»åŠ å·¥å…·è°ƒç”¨æœ€ä½³å®è·µ
- æ·»åŠ æ—©åœæœºåˆ¶ï¼Œå‡å°‘ä¸å¿…è¦çš„è¿­ä»£
- æ·»åŠ å·¥å…·ç»“æœç¼“å­˜

**Phase 3.2**: å¼•å…¥æ„å›¾åˆ†ç±»å™¨
- æ–°å»º `plugin/ai/agent/intent_classifier.go`
- æ ¹æ®å…³é”®è¯åˆ†æµåˆ°ä¸åŒæ‰§è¡Œæ¨¡å¼

**Phase 3.3**: ä¸ºæ‰¹é‡åœºæ™¯å®ç° Plan-Execute
- å‚è€ƒ `amazing_parrot.go` çš„ `planRetrieval` å’Œ `executeConcurrentRetrieval`
- å¤ç”¨ç°æœ‰å·¥å…·ï¼Œå®ç°å¹¶å‘æ‰§è¡Œ

### 3.3 æ™ºèƒ½åŠŸèƒ½å¢å¼º

#### 3.3.1 ç”¨æˆ·ä¹ æƒ¯å­¦ä¹ 

```go
// æ–°å¢å·¥å…·: user_preference_get
type UserPreferenceTool struct {
    memoService  memo.Service  // å¤ç”¨ Memos RAG
    userID       int32
}

// ä»ç”¨æˆ·å†å²æ—¥ç¨‹ä¸­å­¦ä¹ :
// - å¸¸ç”¨æ—¶é•¿ (ä¼šè®®å¹³å‡1å°æ—¶, è·‘æ­¥å¹³å‡40åˆ†é’Ÿ)
// - åå¥½æ—¶æ®µ (ä¸Šåˆé€šå¸¸å®‰æ’ä¸“æ³¨å·¥ä½œ)
// - å¸¸ç”¨åœ°ç‚¹ (ä¼šè®®å®¤A, å¥èº«æˆ¿)
```

#### 3.3.2 ä¸»åŠ¨ä¼˜åŒ–å»ºè®®

```go
// æ–°å¢å·¥å…·: schedule_optimize
type ScheduleOptimizeTool struct {
    scheduleSvc schedule.Service
}

// åŠŸèƒ½:
// - æ£€æµ‹è¿ç»­ä¼šè®®ï¼Œå»ºè®®ä¼‘æ¯æ—¶é—´
// - æ£€æµ‹ç©ºé—²æ—¶æ®µï¼Œæ¨èä»»åŠ¡å®‰æ’
// - å‘¨æœ«/èŠ‚å‡æ—¥æé†’
```

---

## å››ã€å®æ–½è®¡åˆ’ï¼ˆå¹¶è¡Œå®æ–½ï¼‰

> **ç”¨æˆ·é€‰æ‹©**: å‰åç«¯å¹¶è¡Œå®æ–½ï¼Œå¤ç”¨ Memos RAGï¼Œéœ€è¦æ‹–æ‹½äº¤äº’ï¼ŒåŸºç¡€é‡å¤è§„åˆ™æ”¯æŒ

### Phase 1: å‰ç«¯æµå¼åé¦ˆ + Generative UI å¢å¼º

**ç›®æ ‡**: ç”¨æˆ·è¾“å…¥åç«‹å³è·å¾—è§†è§‰åé¦ˆï¼ŒAI ç”Ÿæˆå¯äº¤äº’ç¡®è®¤å¡ç‰‡

**ä¿®æ”¹æ–‡ä»¶**:
| æ–‡ä»¶ | æ”¹åŠ¨ç±»å‹ | è¯´æ˜ |
|------|---------|------|
| `web/src/components/ScheduleQuickInput/ScheduleQuickInput.tsx` | ä¿®æ”¹ | é›†æˆæµå¼åé¦ˆ |
| `web/src/hooks/useScheduleQueries.ts` | ä¿®æ”¹ | æ·»åŠ  SSE æµå¼æ”¯æŒ |
| `web/src/components/ScheduleAI/StreamingFeedback.tsx` | æ–°å¢ | å®æ—¶æ˜¾ç¤º AI æ€è€ƒè¿‡ç¨‹ |
| `web/src/components/ScheduleAI/ScheduleSuggestionCard.tsx` | ä¿®æ”¹ | ä¸°å¯Œäº¤äº’ï¼ˆç¼–è¾‘æ—¶é—´/åœ°ç‚¹ï¼‰ |
| `web/src/components/ScheduleAI/SmartSuggestionBar.tsx` | æ–°å¢ | åŸºäºå†å²çš„æ™ºèƒ½å»ºè®®æ¡ |

**å…³é”®æ”¹åŠ¨**:
1. ä½¿ç”¨ SSE æ¥æ”¶ Agent äº‹ä»¶æµï¼ˆ`thinking`ã€`tool_use`ã€`tool_result`ï¼‰
2. `StreamingFeedback` ç»„ä»¶å®æ—¶æ¸²æŸ“è§£æè¿›åº¦
3. ç¡®è®¤å¡ç‰‡æ”¯æŒå†…è”ç¼–è¾‘æ—¶é—´å’Œåœ°ç‚¹
4. æ™ºèƒ½å»ºè®®æ¡æ˜¾ç¤ºç”¨æˆ·å†å²å¸¸ç”¨æ—¥ç¨‹ç±»å‹

### Phase 2: åç«¯ Agent ä¼˜åŒ–

**ç›®æ ‡**: ä¼˜åŒ–ç°æœ‰ ReAct + ä¸ºæ‰¹é‡åœºæ™¯å¼•å…¥ Plan-Execute

**ä¿®æ”¹æ–‡ä»¶**:
| æ–‡ä»¶ | æ”¹åŠ¨ç±»å‹ | è¯´æ˜ |
|------|---------|------|
| `plugin/ai/agent/scheduler_v2.go` | ä¿®æ”¹ | ä¼˜åŒ–ç³»ç»Ÿæç¤ºï¼Œæ·»åŠ æ—©åœ |
| `plugin/ai/agent/tool_adapter.go` | ä¿®æ”¹ | æ·»åŠ æ€§èƒ½æ—¥å¿—å’Œç»“æœç¼“å­˜ |
| `plugin/ai/agent/intent_classifier.go` | æ–°å¢ | æ„å›¾åˆ†ç±»å™¨ï¼ˆæ‰¹é‡ vs å•ä¸ªï¼‰ |
| `plugin/ai/agent/plan_execute_scheduler.go` | æ–°å¢ | æ‰¹é‡åœºæ™¯çš„ Plan-Execute æ¨¡å¼ |

**å…³é”®æ”¹åŠ¨**:
1. ä¼˜åŒ– `buildSystemPromptV2`ï¼Œæ·»åŠ å·¥å…·è°ƒç”¨æœ€ä½³å®è·µ
2. æ·»åŠ æ—©åœæœºåˆ¶ï¼ˆæ£€æµ‹åˆ°æˆåŠŸåˆ›å»ºå³ç»“æŸï¼‰
3. æ„å›¾åˆ†ç±»å™¨åˆ†æµï¼šç®€å•ä»»åŠ¡ â†’ ReActï¼Œæ‰¹é‡ä»»åŠ¡ â†’ Plan-Execute
4. å‚è€ƒ `amazing_parrot.go` å®ç°å¹¶å‘å·¥å…·æ‰§è¡Œ

### Phase 3: Memory ç³»ç»Ÿï¼ˆå¤ç”¨ Memos RAGï¼‰

**ç›®æ ‡**: ä»ç”¨æˆ·å†å²å­¦ä¹ ä¹ æƒ¯åå¥½

**ä¿®æ”¹æ–‡ä»¶**:
| æ–‡ä»¶ | æ”¹åŠ¨ç±»å‹ | è¯´æ˜ |
|------|---------|------|
| `plugin/ai/agent/tools/preference.go` | æ–°å¢ | ç”¨æˆ·ä¹ æƒ¯æŸ¥è¯¢å·¥å…· |
| `plugin/ai/agent/scheduler_v2.go` | ä¿®æ”¹ | é›†æˆ preference å·¥å…· |

**å…³é”®æ”¹åŠ¨**:
1. `user_preference_get` å·¥å…·é€šè¿‡ Memos RAG æŸ¥è¯¢ç”¨æˆ·å†å²æ—¥ç¨‹
2. åˆ†æå¸¸ç”¨æ—¶é•¿ã€åå¥½æ—¶æ®µã€å¸¸ç”¨åœ°ç‚¹
3. åœ¨åˆ›å»ºæ—¥ç¨‹æ—¶è‡ªåŠ¨è¡¥å…¨é»˜è®¤å€¼

### Phase 4: æ‹–æ‹½äº¤äº’

**ç›®æ ‡**: ç›´æ¥æ‹–æ‹½è°ƒæ•´æ—¥ç¨‹æ—¶é—´

**ä¿®æ”¹æ–‡ä»¶**:
| æ–‡ä»¶ | æ”¹åŠ¨ç±»å‹ | è¯´æ˜ |
|------|---------|------|
| `web/src/components/AIChat/ScheduleTimeline.tsx` | ä¿®æ”¹ | æ·»åŠ æ‹–æ‹½åŠŸèƒ½ |
| `web/src/hooks/useScheduleQueries.ts` | ä¿®æ”¹ | æ·»åŠ ä¹è§‚æ›´æ–° |

**å…³é”®æ”¹åŠ¨**:
1. ä½¿ç”¨ `@dnd-kit/core` æˆ–åŸç”Ÿæ‹–æ‹½ API
2. æ‹–æ‹½æ—¶æ˜¾ç¤ºæ—¶é—´é¢„è§ˆ tooltip
3. æ¾å¼€æ—¶è°ƒç”¨ `schedule_update` API
4. ä¹è§‚æ›´æ–° + å¤±è´¥å›æ»š

### Phase 5: æ™ºèƒ½å·¥å…·æ‰©å±•

**ç›®æ ‡**: æ‰¹é‡åˆ›å»ºå’Œæ—¥ç¨‹ä¼˜åŒ–

**ä¿®æ”¹æ–‡ä»¶**:
| æ–‡ä»¶ | æ”¹åŠ¨ç±»å‹ | è¯´æ˜ |
|------|---------|------|
| `plugin/ai/agent/tools/scheduler.go` | ä¿®æ”¹ | æ·»åŠ  `schedule_batch_add` |
| `plugin/ai/agent/tools/optimizer.go` | æ–°å¢ | æ—¥ç¨‹ä¼˜åŒ–å»ºè®®å·¥å…· |

**å…³é”®æ”¹åŠ¨**:
1. `schedule_batch_add` æ”¯æŒåŸºç¡€é‡å¤è§„åˆ™ï¼ˆæ¯å¤©/æ¯å‘¨/æ¯æœˆï¼‰
2. `schedule_optimize` æ£€æµ‹è¿ç»­ä¼šè®®ï¼Œå»ºè®®ä¼‘æ¯æ—¶é—´

---

## äº”ã€å…³é”®æ–‡ä»¶æ¸…å•

### å‰ç«¯ (å¹¶è¡Œå¼€å‘)
```
web/src/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ScheduleQuickInput/
â”‚   â”‚   â””â”€â”€ ScheduleQuickInput.tsx     # ä¿®æ”¹: é›†æˆæµå¼åé¦ˆ
â”‚   â”œâ”€â”€ ScheduleAI/
â”‚   â”‚   â”œâ”€â”€ StreamingFeedback.tsx      # æ–°å¢: AI æ€è€ƒè¿‡ç¨‹å±•ç¤º
â”‚   â”‚   â”œâ”€â”€ SmartSuggestionBar.tsx     # æ–°å¢: æ™ºèƒ½å»ºè®®æ¡
â”‚   â”‚   â”œâ”€â”€ ScheduleSuggestionCard.tsx # ä¿®æ”¹: ä¸°å¯Œäº¤äº’
â”‚   â”‚   â””â”€â”€ ConflictResolution.tsx     # ä¿®æ”¹: å¯è§†åŒ–æ—¶é—´è½´
â”‚   â””â”€â”€ AIChat/
â”‚       â””â”€â”€ ScheduleTimeline.tsx       # ä¿®æ”¹: æ‹–æ‹½æ”¯æŒ
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ useScheduleQueries.ts          # ä¿®æ”¹: SSE + ä¹è§‚æ›´æ–°
â””â”€â”€ locales/
    â”œâ”€â”€ en.json                        # ä¿®æ”¹: i18n
    â””â”€â”€ zh-Hans.json                   # ä¿®æ”¹: i18n
```

### åç«¯ (å¹¶è¡Œå¼€å‘)
```
plugin/ai/agent/
â”œâ”€â”€ scheduler_v2.go                    # ä¿®æ”¹: ä¼˜åŒ–æç¤º + æ—©åœ
â”œâ”€â”€ tool_adapter.go                    # ä¿®æ”¹: æ€§èƒ½æ—¥å¿— + ç¼“å­˜
â”œâ”€â”€ intent_classifier.go               # æ–°å¢: æ„å›¾åˆ†ç±»å™¨
â”œâ”€â”€ plan_execute_scheduler.go          # æ–°å¢: æ‰¹é‡åœºæ™¯ Plan-Execute
â””â”€â”€ tools/
    â”œâ”€â”€ scheduler.go                   # ä¿®æ”¹: schedule_batch_add
    â”œâ”€â”€ preference.go                  # æ–°å¢: user_preference_get
    â””â”€â”€ optimizer.go                   # æ–°å¢: schedule_optimize
```

---

## å…­ã€éªŒè¯æ–¹æ¡ˆ

### 6.1 åŠŸèƒ½éªŒè¯

```bash
# å¯åŠ¨å¼€å‘ç¯å¢ƒ
make start

# æµ‹è¯•åœºæ™¯
1. è¾“å…¥ "æ˜å¤©ä¸‹åˆ3ç‚¹å¼€ä¼š" 
   â†’ éªŒè¯: æµå¼åé¦ˆæ˜¾ç¤ºè§£æè¿‡ç¨‹ + ç¡®è®¤å¡ç‰‡å¯ç¼–è¾‘

2. è¾“å…¥ "æ¯å¤©æ—©ä¸Š7ç‚¹è·‘æ­¥" 
   â†’ éªŒè¯: æ„å›¾åˆ†ç±»ä¸ºæ‰¹é‡ â†’ Plan-Execute å¹¶å‘åˆ›å»º

3. åˆ›å»ºå†²çªæ—¥ç¨‹ 
   â†’ éªŒè¯: å†²çªè§£å†³ UI æ˜¾ç¤ºå¯è§†åŒ–æ—¶é—´æ§½

4. æ‹–æ‹½ Timeline ä¸­çš„æ—¥ç¨‹ 
   â†’ éªŒè¯: æ—¶é—´é¢„è§ˆ + æ¾å¼€åæ›´æ–°æˆåŠŸ

5. è¾“å…¥ "è·‘æ­¥" (æ— æ—¶é—´)
   â†’ éªŒè¯: ä»å†å²ä¹ æƒ¯è‡ªåŠ¨è¡¥å…¨æ—¶é—´å’Œæ—¶é•¿
```

### 6.2 æŠ€æœ¯éªŒè¯

```bash
# åç«¯æµ‹è¯•
make test

# å‰ç«¯ç±»å‹æ£€æŸ¥
cd web && npm run typecheck

# Lint æ£€æŸ¥
cd web && npm run lint

# i18n æ£€æŸ¥
make check-i18n
```

### 6.3 æ€§èƒ½éªŒè¯

| æŒ‡æ ‡ | åŸºçº¿ | ç›®æ ‡ |
|------|------|------|
| ç®€å•åˆ›å»ºå»¶è¿Ÿ | ~2s | <1.5s |
| æ‰¹é‡åˆ›å»ºå»¶è¿Ÿ | ~8s (5ä¸ª) | <3s (å¹¶å‘) |
| æµå¼é¦–å­—èŠ‚ | N/A | <500ms |

---

## ä¸ƒã€é£é™©ä¸ç¼“è§£

| é£é™© | ç¼“è§£æªæ–½ |
|------|---------|
| æ„å›¾åˆ†ç±»ä¸å‡†ç¡® | å…ˆç”¨å…³é”®è¯åŒ¹é…ï¼Œåç»­å¯å‡çº§ä¸ºè½»é‡ LLM |
| æ‹–æ‹½åœ¨ç§»åŠ¨ç«¯ä½“éªŒå·® | ç§»åŠ¨ç«¯é™çº§ä¸ºç‚¹å‡»ç¼–è¾‘ |
| Memos RAG æŸ¥è¯¢æ…¢ | æ·»åŠ ç¼“å­˜å±‚ï¼Œé™åˆ¶æŸ¥è¯¢èŒƒå›´ |
| i18n é—æ¼ | æ¯ä¸ª Phase å®Œæˆåè¿è¡Œ `make check-i18n` |

---

## å…«ã€é¢„æœŸæˆæœ

1. **ç”¨æˆ·ä½“éªŒ**
   - è¾“å…¥åç«‹å³çœ‹åˆ° AI æ€è€ƒè¿‡ç¨‹ï¼ˆæµå¼åé¦ˆï¼‰
   - ç¡®è®¤å¡ç‰‡æ”¯æŒå†…è”ç¼–è¾‘ï¼ˆå‡å°‘æ­¥éª¤ï¼‰
   - æ‹–æ‹½è°ƒæ•´æ—¶é—´ï¼ˆç›´è§‚æ“ä½œï¼‰

2. **æ™ºèƒ½èƒ½åŠ›**
   - æ‰¹é‡ä»»åŠ¡å¹¶å‘æ‰§è¡Œï¼ˆå»¶è¿Ÿé™ä½ 50%+ï¼‰
   - è‡ªåŠ¨å­¦ä¹ ç”¨æˆ·ä¹ æƒ¯ï¼ˆå‡å°‘è¾“å…¥æˆæœ¬ï¼‰
   - ä¸»åŠ¨ä¼˜åŒ–å»ºè®®ï¼ˆè¿ç»­ä¼šè®®æé†’ä¼‘æ¯ï¼‰

3. **æ¶æ„ä¼˜åŒ–**
   - æ··åˆæ¨¡å¼ï¼ˆReAct + Plan-Executeï¼‰å…¼é¡¾çµæ´»æ€§å’Œæ€§èƒ½
   - å¤ç”¨ Memos RAG ä½œä¸º Memory ç³»ç»Ÿï¼ˆé›¶é¢å¤–å­˜å‚¨ï¼‰
